(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    330292,       7911]
NotebookOptionsPosition[    320148,       7682]
NotebookOutlinePosition[    320496,       7697]
CellTagsIndexPosition[    320453,       7694]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Cube Diagram Calculator 1.0", "Title",
 CellChangeTimes->{{3.4579095718105*^9, 3.45790957609175*^9}, {
  3.45791256321675*^9, 3.457912564169875*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Cube Diagram Calculator 1.0\nCopyright \[Copyright] 2009 Scott Baldridge \
and Adam Lowrance\n",
 StyleBox["(Open this cell for information on how to cite and the GNU Lesser \
Public Licence)",
  FontFamily->"Arial",
  FontSize->18,
  FontWeight->"Plain",
  FontSlant->"Italic"]
}], "Section",
 CellChangeTimes->{{3.45790958834175*^9, 3.45790962834175*^9}, {
  3.457910864044875*^9, 3.45791092584175*^9}, {3.4579110058105*^9, 
  3.457911033638625*^9}, {3.457912574701125*^9, 3.45791257596675*^9}}],

Cell[TextData[StyleBox["Please cite this work.  If you use this program in \
your work, please cite the following  article:\n\nS. Baldridge and A. \
Lowrance, Cube Diagrams and a homology theory for knots, arXiv:0811.0225.\n\n\
Thank you!",
 FontFamily->"Times New Roman",
 FontSize->14,
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{
  3.457909697748*^9, {3.457909855263625*^9, 3.457909901623*^9}},
 Background->RGBColor[0.87, 0.94, 1]],

Cell["\<\
  GNU LESSER GENERAL PUBLIC LICENSE
                       Version 3, 29 June 2007

 Copyright (C) 2007 Free Software Foundation, Inc. <http://fsf.org/>
 Everyone is permitted to copy and distribute verbatim copies
 of this license document, but changing it is not allowed.


  This version of the GNU Lesser General Public License incorporates
the terms and conditions of version 3 of the GNU General Public
License, supplemented by the additional permissions listed below.

  0. Additional Definitions.

  As used herein, \"this License\" refers to version 3 of the GNU Lesser
General Public License, and the \"GNU GPL\" refers to version 3 of the GNU
General Public License.

  \"The Library\" refers to a covered work governed by this License,
other than an Application or a Combined Work as defined below.

  An \"Application\" is any work that makes use of an interface provided
by the Library, but which is not otherwise based on the Library.
Defining a subclass of a class defined by the Library is deemed a mode
of using an interface provided by the Library.

  A \"Combined Work\" is a work produced by combining or linking an
Application with the Library.  The particular version of the Library
with which the Combined Work was made is also called the \"Linked
Version\".

  The \"Minimal Corresponding Source\" for a Combined Work means the
Corresponding Source for the Combined Work, excluding any source code
for portions of the Combined Work that, considered in isolation, are
based on the Application, and not on the Linked Version.

  The \"Corresponding Application Code\" for a Combined Work means the
object code and/or source code for the Application, including any data
and utility programs needed for reproducing the Combined Work from the
Application, but excluding the System Libraries of the Combined Work.

  1. Exception to Section 3 of the GNU GPL.

  You may convey a covered work under sections 3 and 4 of this License
without being bound by section 3 of the GNU GPL.

  2. Conveying Modified Versions.

  If you modify a copy of the Library, and, in your modifications, a
facility refers to a function or data to be supplied by an Application
that uses the facility (other than as an argument passed when the
facility is invoked), then you may convey a copy of the modified
version:

   a) under this License, provided that you make a good faith effort to
   ensure that, in the event an Application does not supply the
   function or data, the facility still operates, and performs
   whatever part of its purpose remains meaningful, or

   b) under the GNU GPL, with none of the additional permissions of
   this License applicable to that copy.

  3. Object Code Incorporating Material from Library Header Files.

  The object code form of an Application may incorporate material from
a header file that is part of the Library.  You may convey such object
code under terms of your choice, provided that, if the incorporated
material is not limited to numerical parameters, data structure
layouts and accessors, or small macros, inline functions and templates
(ten or fewer lines in length), you do both of the following:

   a) Give prominent notice with each copy of the object code that the
   Library is used in it and that the Library and its use are
   covered by this License.

   b) Accompany the object code with a copy of the GNU GPL and this license
   document.

  4. Combined Works.

  You may convey a Combined Work under terms of your choice that,
taken together, effectively do not restrict modification of the
portions of the Library contained in the Combined Work and reverse
engineering for debugging such modifications, if you also do each of
the following:

   a) Give prominent notice with each copy of the Combined Work that
   the Library is used in it and that the Library and its use are
   covered by this License.

   b) Accompany the Combined Work with a copy of the GNU GPL and this license
   document.

   c) For a Combined Work that displays copyright notices during
   execution, include the copyright notice for the Library among
   these notices, as well as a reference directing the user to the
   copies of the GNU GPL and this license document.

   d) Do one of the following:

       0) Convey the Minimal Corresponding Source under the terms of this
       License, and the Corresponding Application Code in a form
       suitable for, and under terms that permit, the user to
       recombine or relink the Application with a modified version of
       the Linked Version to produce a modified Combined Work, in the
       manner specified by section 6 of the GNU GPL for conveying
       Corresponding Source.

       1) Use a suitable shared library mechanism for linking with the
       Library.  A suitable mechanism is one that (a) uses at run time
       a copy of the Library already present on the user's computer
       system, and (b) will operate properly with a modified version
       of the Library that is interface-compatible with the Linked
       Version.

   e) Provide Installation Information, but only if you would otherwise
   be required to provide such information under section 6 of the
   GNU GPL, and only to the extent that such information is
   necessary to install and execute a modified version of the
   Combined Work produced by recombining or relinking the
   Application with a modified version of the Linked Version. (If
   you use option 4d0, the Installation Information must accompany
   the Minimal Corresponding Source and Corresponding Application
   Code. If you use option 4d1, you must provide the Installation
   Information in the manner specified by section 6 of the GNU GPL
   for conveying Corresponding Source.)

  5. Combined Libraries.

  You may place library facilities that are a work based on the
Library side by side in a single library together with other library
facilities that are not Applications and are not covered by this
License, and convey such a combined library under terms of your
choice, if you do both of the following:

   a) Accompany the combined library with a copy of the same work based
   on the Library, uncombined with any other library facilities,
   conveyed under the terms of this License.

   b) Give prominent notice with the combined library that part of it
   is a work based on the Library, and explaining where to find the
   accompanying uncombined form of the same work.

  6. Revised Versions of the GNU Lesser General Public License.

  The Free Software Foundation may publish revised and/or new versions
of the GNU Lesser General Public License from time to time. Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.

  Each version is given a distinguishing version number. If the
Library as you received it specifies that a certain numbered version
of the GNU Lesser General Public License \"or any later version\"
applies to it, you have the option of following the terms and
conditions either of that published version or of any later version
published by the Free Software Foundation. If the Library as you
received it does not specify a version number of the GNU Lesser
General Public License, you may choose any version of the GNU Lesser
General Public License ever published by the Free Software Foundation.

  If the Library as you received it specifies that a proxy can decide
whether future versions of the GNU Lesser General Public License shall
apply, that proxy's public statement of acceptance of any version is
permanent authorization for you to choose that version for the
Library.\
\>", "Text",
 CellChangeTimes->{
  3.45791002727925*^9, {3.457911069873*^9, 3.457911084201125*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Commands", "Section",
 CellChangeTimes->{{3.457910714638625*^9, 3.457910715763625*^9}}],

Cell[CellGroupData[{

Cell["RandomLink", "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4450133981939287`*^9, 3.445013434275919*^9}, 
   3.445027412844702*^9, 3.445027479293374*^9, 3.457910816482375*^9}],

Cell["\<\
The input for RandomLink is an integer greater than 2. The result is a \
lattice link of size equal to the input that satisfies the marking conditions \
but not necessarily the crossing conditions\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.445013448650241*^9, 3.445013493796649*^9}, {
   3.445014239050458*^9, 3.445014242818758*^9}, 3.4450274128447943`*^9, 
   3.445027479293461*^9, 3.457910816482375*^9}],

Cell["GoodCube", "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4450142190708733`*^9, 3.445014221818324*^9}, 
   3.445027412844883*^9, 3.445027479293544*^9, 3.457910816482375*^9}],

Cell["\<\
The input for GoodCube is a link and an integer (1 or 0). If the integer \
input is odd, the fucntion will output either True if the link satisfies the \
correct crossing conditions for the standard x-y-z orientation and False \
otherwise.  If the integer input is even, the function will output True if \
the link satisfies the correct crossing conditions for the x-z-y orientation \
and False otherwise.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.445014233026607*^9, 3.4450143067148333`*^9}, 
   3.445027412844969*^9, 3.4450274792936287`*^9, 3.457910578623*^9, 
   3.457910816482375*^9}],

Cell["Draw3DLink", "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4450143929406*^9, 3.445014397163391*^9}, 
   3.445027412845056*^9, 3.445027479293848*^9, 3.457910816482375*^9}],

Cell["\<\
The input for Draw3DLink is a link. It will output a picture of the link. The \
x-axis is marked with a large sphere, the y-axis is marked with a medium \
sphere, and the z-axis is marked with a small sphere.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4450144093503847`*^9, 3.445014472575355*^9}, 
   3.445027412845142*^9, 3.445027479293951*^9, 3.457910816482375*^9}],

Cell["Commutation", "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.445014949946313*^9, 3.445014951420617*^9}, 
   3.445027412845228*^9, 3.445027479294038*^9, 3.457910816482375*^9}],

Cell["\<\
The input for Commutation is a link, one of the integers {1, 2, 3}, and an \
integer between 1 and the size of the cube diagram. The integer from {1, 2, \
3} determines whether two x-flats, y-flats, or z-flats will be commuted. The \
integer between 1 and the size of the cube diagram will determine which flats \
will be commuted. If the commutation results in a cube diagram (i.e. the \
crossing conditions hold), then this function returns the commuted link. \
However, if the commutation does not result in a cube diagram, then it \
returns the input link.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.445014961857164*^9, 3.445014989741105*^9}, {
   3.445015046774197*^9, 3.4450152167256327`*^9}, 3.445027412845312*^9, 
   3.4450274792941227`*^9, {3.447943019515625*^9, 3.447943025109375*^9}, {
   3.457910816482375*^9, 3.457910834951125*^9}}],

Cell["CubeHomology", "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.445015382677619*^9, 3.445015384721736*^9}, {
   3.4450274621824083`*^9, 3.445027479294208*^9}, 3.457910816482375*^9}],

Cell["\<\
The input for CubeHomology is a cube diagram, and two integers from {1, 2, 3} \
without repeats. The output is the cube homology with chosen projections \
corresponding to the two input integers. The output is of the form {minimum \
Alexander grading, maximum Alexander grading, minimum Maslov grading, maximum \
Maslov grading, homology matrix}\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.457910816482375*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Source Code", "Subtitle",
 FontFamily->"Arial",
 FontSize->20]], "Section",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.445028815067937*^9, 3.445028816658276*^9}}],

Cell[TextData[StyleBox["In order to do calculations for the other notebooks \
found at cubeknots.googlecode.com, all code beyond this point must first be \
evaluated.",
 FontFamily->"Times New Roman",
 FontSize->16,
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Text",
 CellChangeTimes->{{3.4450288266252213`*^9, 3.445028843138176*^9}, {
   3.447947846890625*^9, 3.447947857171875*^9}, {3.457910050638625*^9, 
   3.457910053013625*^9}, {3.4579112174355*^9, 3.457911225482375*^9}, {
   3.4579112958105*^9, 3.457911304373*^9}, 3.45791136196675*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"printmarkers", "=", "False"}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4450213163338842`*^9, 3.445021334338788*^9}}],

Cell["\<\
This function takes a link projection with integer coordinates and shifts \
each coordinate entry down by one half.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402587436265625*^9, 3.402587478703125*^9}, 
   3.402857302890625*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ShiftLink", "[", "proj_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "shift", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"shift", "=", "proj"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"shift", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{"shift", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "-", 
              RowBox[{"1", "/", "2"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"shift", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"shift", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "shift", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "shift", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402586444359375*^9, 3.402586529765625*^9}, {
   3.402586562*^9, 3.40258658921875*^9}, 3.402586633515625*^9, {
   3.402587257671875*^9, 3.402587314015625*^9}, {3.40258737259375*^9, 
   3.40258739190625*^9}, {3.402587665171875*^9, 3.402587689828125*^9}, {
   3.402587806*^9, 3.402587820890625*^9}, 3.4025879220625*^9, 
   3.402857302890625*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UnShiftLink", "[", "link_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "shift", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"shift", "=", "link"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"shift", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{"shift", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "+", 
              RowBox[{"1", "/", "2"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"shift", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"shift", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "shift", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "shift", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.40338075034375*^9, 3.403380855078125*^9}, 
   3.4033813855625*^9}],

Cell["\<\
This function will take two sets of points A and B in the plane and output \
the number of pairs of points (a,b) where a is less than b in our partial \
ordering.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.40258830965625*^9, 3.402588363484375*^9}, 
   3.402857302890625*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PlanePartialCount", "[", 
    RowBox[{"A_", ",", "B_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "n", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"A", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "<", 
              RowBox[{"B", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "&&", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"A", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], "<", 
              RowBox[{"B", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"n", "=", 
              RowBox[{"n", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "B", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "A", "]"}]}], "}"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "n", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402588380953125*^9, 3.402588388046875*^9}, {
   3.40258844934375*^9, 3.402588484296875*^9}, {3.4025885884375*^9, 
   3.402588652453125*^9}, 3.402857302890625*^9}],

Cell["\<\
This function will generate a list of all states as coordinates. These \
correspond to interesection points of the two tori defined by the alpha and \
beta curves on our grid diagrams.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402588986234375*^9, 3.402589036796875*^9}, 
   3.402857302890625*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PlaneStates", "[", "n_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "statelist", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"statelist", "=", 
       RowBox[{"Permutations", "[", 
        RowBox[{"Range", "[", "n", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"statelist", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"statelist", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"statelist", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], "\[Equal]", 
              "n"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"statelist", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], "=", "0"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"statelist", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "\[Equal]", 
              "n"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"statelist", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "=", "0"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"statelist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "statelist", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "statelist", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4025891585625*^9, 3.402589168765625*^9}, {
   3.40258926078125*^9, 3.40258929990625*^9}, {3.402589349390625*^9, 
   3.402589411609375*^9}, {3.40258945759375*^9, 3.4025895375*^9}, 
   3.402857302890625*^9}],

Cell["\<\
This function will find the Maslov (homological) index of a state for a \
planar grid diagram.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4025909586875*^9, 3.40259098671875*^9}, 
   3.402857302890625*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Maslov", "[", 
    RowBox[{"state_", ",", "link_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"PlanePartialCount", "[", 
     RowBox[{"state", ",", "state"}], "]"}], "-", 
    RowBox[{"PlanePartialCount", "[", 
     RowBox[{"state", ",", 
      RowBox[{"link", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "-", 
    RowBox[{"PlanePartialCount", "[", 
     RowBox[{
      RowBox[{"link", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "state"}], "]"}], "+", 
    RowBox[{"PlanePartialCount", "[", 
     RowBox[{
      RowBox[{"link", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"link", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "+", "1"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.40258941234375*^9, 3.402589413171875*^9}, {
   3.4025907445625*^9, 3.40259083884375*^9}, {3.40259088128125*^9, 
   3.402590949078125*^9}, {3.40259113915625*^9, 3.402591152484375*^9}, 
   3.402857302890625*^9}],

Cell["\<\
This function will find the Alexander (polynomial) grading of a state for a \
planar grid diagram.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402591294109375*^9, 3.402591311203125*^9}, 
   3.402857302890625*^9, 3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Alexander", "[", 
    RowBox[{"state_", ",", "link_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"1", "/", "2"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PlanePartialCount", "[", 
       RowBox[{
        RowBox[{"link", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"link", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "-", 
      RowBox[{"PlanePartialCount", "[", 
       RowBox[{
        RowBox[{"link", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"link", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "-", 
      RowBox[{"PlanePartialCount", "[", 
       RowBox[{"state", ",", 
        RowBox[{"link", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "-", 
      RowBox[{"PlanePartialCount", "[", 
       RowBox[{
        RowBox[{"link", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "state"}], "]"}], "+", 
      RowBox[{"PlanePartialCount", "[", 
       RowBox[{"state", ",", 
        RowBox[{"link", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "+", 
      RowBox[{"PlanePartialCount", "[", 
       RowBox[{
        RowBox[{"link", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "state"}], "]"}], "-", 
      RowBox[{"Length", "[", 
       RowBox[{"link", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", "1"}], ")"}]}]}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402591314796875*^9, 3.402591324171875*^9}, {
   3.40259218884375*^9, 3.402592311453125*^9}, {3.402776363609375*^9, 
   3.402776491359375*^9}, 3.402857302890625*^9, 3.402857370234375*^9}],

Cell["\<\
This function will create a list of faces that are in each Alexander \
filtration level.  \
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402592497859375*^9, 3.402592573546875*^9}, {
   3.402594641359375*^9, 3.40259466221875*^9}, 3.402857302890625*^9, 
   3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AlexFilter", "[", "link_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "statelist", ",", "alexcom", ",", "alexcnt", ",", "alexind", ",", 
        "templist"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"statelist", "=", 
        RowBox[{"PlaneStates", "[", 
         RowBox[{"Length", "[", 
          RowBox[{"link", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"alexcom", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"alexcnt", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"templist", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"statelist", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Alexander", "[", 
             RowBox[{"#", ",", "link"}], "]"}], "\[Equal]", "0"}], "&"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"templist", "\[NotEqual]", 
          RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"alexcom", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"alexcom", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "templist"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"alexcnt", "=", 
           RowBox[{"alexcnt", "+", 
            RowBox[{"Length", "[", "templist", "]"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"alexind", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"alexcnt", "<", 
          RowBox[{"Length", "[", "statelist", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"templist", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"statelist", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Alexander", "[", 
                RowBox[{"#", ",", "link"}], "]"}], "\[Equal]", 
               RowBox[{
                RowBox[{"1", "/", "2"}], "*", "alexind"}]}], "&"}]}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"templist", "\[NotEqual]", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"alexcom", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"alexcom", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"1", "/", "2"}], "*", "alexind"}], ",", 
                  "templist"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"alexcnt", "=", 
              RowBox[{"alexcnt", "+", 
               RowBox[{"Length", "[", "templist", "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"templist", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"statelist", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Alexander", "[", 
                RowBox[{"#", ",", "link"}], "]"}], "\[Equal]", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}], "*", "alexind"}]}], "&"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"templist", "\[NotEqual]", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"alexcom", "=", 
              RowBox[{"Prepend", "[", 
               RowBox[{"alexcom", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}], "*", "alexind"}], ",", 
                  "templist"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"alexcnt", "=", 
              RowBox[{"alexcnt", "+", 
               RowBox[{"Length", "[", "templist", "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"alexind", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "alexcom", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402592578734375*^9, 3.402592752359375*^9}, {
   3.40259278684375*^9, 3.40259278903125*^9}, {3.402592846515625*^9, 
   3.40259286159375*^9}, {3.402592929625*^9, 3.402592969609375*^9}, {
   3.402593027859375*^9, 3.402593094296875*^9}, {3.40259312725*^9, 
   3.40259314509375*^9}, {3.402593195671875*^9, 3.402593216234375*^9}, {
   3.402593336890625*^9, 3.40259334575*^9}, {3.40259339825*^9, 
   3.40259341575*^9}, {3.4025934536875*^9, 3.40259348215625*^9}, {
   3.402594666234375*^9, 3.402594905*^9}, {3.4025949401875*^9, 
   3.4025950069375*^9}, {3.402595069703125*^9, 3.40259507453125*^9}, 
   3.40285730290625*^9, 3.402857370234375*^9}],

Cell["\<\
This function will produce the bi-graded chain complex for a planar grid \
diagram.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.40259510740625*^9, 3.402595160015625*^9}, 
   3.40285730290625*^9, 3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PlaneComplex", "[", "link_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "chncom", ",", "alexfil", ",", "templist", ",", "masind", ",", "mascnt",
        ",", "tempmas"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"alexfil", "=", 
       RowBox[{"AlexFilter", "[", "link", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"chncom", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"mascnt", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"chncom", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"chncom", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"alexfil", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"templist", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"alexfil", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Maslov", "[", 
               RowBox[{"#", ",", "link"}], "]"}], "\[Equal]", "0"}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"templist", "\[NotEqual]", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"chncom", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"chncom", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "templist"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"mascnt", "=", 
             RowBox[{"mascnt", "+", 
              RowBox[{"Length", "[", "templist", "]"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"masind", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"mascnt", "<", 
            RowBox[{"Length", "[", 
             RowBox[{"alexfil", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"templist", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"alexfil", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Maslov", "[", 
                  RowBox[{"#", ",", "link"}], "]"}], "\[Equal]", "masind"}], 
                "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"templist", "\[NotEqual]", 
               RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"chncom", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"chncom", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"masind", ",", "templist"}], "}"}]}], "]"}]}], ";",
                "\[IndentingNewLine]", 
               RowBox[{"mascnt", "=", 
                RowBox[{"mascnt", "+", 
                 RowBox[{"Length", "[", "templist", "]"}]}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"templist", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"alexfil", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Maslov", "[", 
                  RowBox[{"#", ",", "link"}], "]"}], "\[Equal]", 
                 RowBox[{"-", "masind"}]}], "&"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"templist", "\[NotEqual]", 
               RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"chncom", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
                RowBox[{"Prepend", "[", 
                 RowBox[{
                  RowBox[{"chncom", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "masind"}], ",", "templist"}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"mascnt", "=", 
                RowBox[{"mascnt", "+", 
                 RowBox[{"Length", "[", "templist", "]"}]}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"masind", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "alexfil", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "chncom", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402595140421875*^9, 3.402595168328125*^9}, {
   3.402595538546875*^9, 3.402595567296875*^9}, {3.402595663640625*^9, 
   3.402595717390625*^9}, {3.402595750203125*^9, 3.40259578665625*^9}, {
   3.402595932671875*^9, 3.40259596146875*^9}, {3.402595997484375*^9, 
   3.40259601428125*^9}, {3.402596105828125*^9, 3.40259610621875*^9}, {
   3.402596189421875*^9, 3.402596248203125*^9}, {3.402596280640625*^9, 
   3.402596307078125*^9}, {3.4025964128125*^9, 3.4025964653125*^9}, {
   3.40259650190625*^9, 3.4025967478125*^9}, 3.402597120609375*^9, {
   3.402608141640625*^9, 3.402608143546875*^9}, 3.40285730290625*^9, 
   3.402857370234375*^9}],

Cell["\<\
This function will take a list of ordered pairs (or triples) and arrange them \
in numerical order according to their first coordinates.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402598532359375*^9, 3.402598536734375*^9}, {
   3.4025986105*^9, 3.40259863275*^9}, 3.40285730290625*^9, 
   3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OrderCoordinates", "[", "coordlist_", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "newcoord", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newcoord", "=", 
        RowBox[{"{", 
         RowBox[{"coordlist", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"coordlist", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "<", 
             RowBox[{"newcoord", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"newcoord", "=", 
              RowBox[{"Prepend", "[", 
               RowBox[{"newcoord", ",", 
                RowBox[{"coordlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"coordlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
                RowBox[{"newcoord", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "&&", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"coordlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], "<", 
                RowBox[{"newcoord", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"j", "+", "1"}], ",", "1"}], "]"}], "]"}]}]}], ",",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newcoord", "=", 
                RowBox[{"Insert", "[", 
                 RowBox[{"newcoord", ",", 
                  RowBox[{"coordlist", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"j", "+", "1"}]}], "]"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{
               RowBox[{"Length", "[", "newcoord", "]"}], "-", "1"}]}], 
             "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"coordlist", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
             RowBox[{"newcoord", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Length", "[", "newcoord", "]"}], ",", "1"}], "]"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"newcoord", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"newcoord", ",", 
               RowBox[{"coordlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "coordlist", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "newcoord", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4025986880625*^9, 3.40259874084375*^9}, {
   3.402598808765625*^9, 3.402598809375*^9}, {3.4025988426875*^9, 
   3.402598958078125*^9}, {3.40259899753125*^9, 3.40259903675*^9}, {
   3.402599127734375*^9, 3.402599154796875*^9}, {3.40259919659375*^9, 
   3.402599299765625*^9}, {3.402599545953125*^9, 3.40259955359375*^9}, {
   3.40259960371875*^9, 3.402599611625*^9}, {3.402599657546875*^9, 
   3.402599657671875*^9}, {3.402599738953125*^9, 3.402599746203125*^9}, 
   3.40285730290625*^9, 3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OrderCoordinatesAt", "[", 
     RowBox[{"coordlist_", ",", "h_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "newcoord", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newcoord", "=", 
        RowBox[{"{", 
         RowBox[{"coordlist", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"coordlist", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "h"}], "]"}], "]"}], "<", 
             RowBox[{"newcoord", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "h"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"newcoord", "=", 
              RowBox[{"Prepend", "[", 
               RowBox[{"newcoord", ",", 
                RowBox[{"coordlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"coordlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "h"}], "]"}], "]"}], ">", 
                RowBox[{"newcoord", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "h"}], "]"}], "]"}]}], "&&", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"coordlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "h"}], "]"}], "]"}], "<", 
                RowBox[{"newcoord", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"j", "+", "1"}], ",", "h"}], "]"}], "]"}]}]}], ",",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newcoord", "=", 
                RowBox[{"Insert", "[", 
                 RowBox[{"newcoord", ",", 
                  RowBox[{"coordlist", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"j", "+", "1"}]}], "]"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{
               RowBox[{"Length", "[", "newcoord", "]"}], "-", "1"}]}], 
             "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"coordlist", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "h"}], "]"}], "]"}], ">", 
             RowBox[{"newcoord", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Length", "[", "newcoord", "]"}], ",", "h"}], "]"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"newcoord", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"newcoord", ",", 
               RowBox[{"coordlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "coordlist", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "newcoord", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4025986880625*^9, 3.40259874084375*^9}, {
   3.402598808765625*^9, 3.402598809375*^9}, {3.4025988426875*^9, 
   3.402598958078125*^9}, {3.40259899753125*^9, 3.40259903675*^9}, {
   3.402599127734375*^9, 3.402599154796875*^9}, {3.40259919659375*^9, 
   3.402599299765625*^9}, {3.402599545953125*^9, 3.40259955359375*^9}, {
   3.40259960371875*^9, 3.402599611625*^9}, {3.402599657546875*^9, 
   3.402599657671875*^9}, {3.402599738953125*^9, 3.402599746203125*^9}, 
   3.402830587953125*^9, 3.40283069903125*^9, {3.44085740247225*^9, 
   3.440857469456625*^9}, {3.440857594019125*^9, 3.440857602706625*^9}}],

Cell["\<\
This function will take cube grid diagram and project it into a planar grid \
diagram. The second input is the index of the projection\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402598123578125*^9, 3.40259814975*^9}, {
   3.40259820046875*^9, 3.402598208546875*^9}, 3.40285730290625*^9, 
   3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProjectCubeDiagram", "[", 
    RowBox[{"cube_", ",", "proj_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"plane", ",", "newplane"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"plane", "=", "cube"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"plane", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{"Delete", "[", 
             RowBox[{
              RowBox[{"plane", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "proj"}], "]"}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"plane", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"plane", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"OrderCoordinates", "[", 
           RowBox[{"plane", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"plane", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
         RowBox[{"plane", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"plane", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"plane", ",", "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"plane", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"plane", ",", "3"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"newplane", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"X", "[", "]"}], ",", 
         RowBox[{"Y", "[", "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"newplane", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "=", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"newplane", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"plane", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i"}], "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newplane", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "=", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"newplane", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"plane", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i"}], "]"}], "]"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"plane", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "newplane", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402598210828125*^9, 3.402598227546875*^9}, {
   3.40259831021875*^9, 3.40259831078125*^9}, {3.402598597640625*^9, 
   3.40259860584375*^9}, {3.402599833765625*^9, 3.402599848375*^9}, {
   3.40259998775*^9, 3.402600014140625*^9}, {3.402600473234375*^9, 
   3.402600553703125*^9}, {3.402600602625*^9, 3.40260065659375*^9}, {
   3.402600765015625*^9, 3.402600789609375*^9}, {3.40260112546875*^9, 
   3.402601128296875*^9}, {3.402601272015625*^9, 3.402601319578125*^9}, {
   3.402601430375*^9, 3.402601515203125*^9}, 3.402601929859375*^9, 
   3.402857302921875*^9, 3.402857370234375*^9}],

Cell["\<\
This function will generate the list of states for a cube grid diagram. These \
states are given as ordered triples of points.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.40260194178125*^9, 3.402601970046875*^9}, {
   3.4026020434375*^9, 3.40260204796875*^9}, 3.402857302921875*^9, 
   3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CubeStates", "[", "n_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"statelist", ",", "perm", ",", "entry"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"statelist", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"perm", "=", 
       RowBox[{"Permutations", "[", 
        RowBox[{"Range", "[", "n", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"entry", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"entry", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"entry", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"perm", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}], ",", 
                  RowBox[{"perm", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"k", ",", "n"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"statelist", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"statelist", ",", "entry"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "perm", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "perm", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"statelist", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"statelist", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "j"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"statelist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "statelist", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"statelist", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "\[Equal]", 
               "n"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"statelist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "=", "0"}],
                ";"}]}], "\[IndentingNewLine]", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"k", ",", "3"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"statelist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "statelist", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "statelist", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402602062140625*^9, 3.402602095140625*^9}, {
   3.402602200609375*^9, 3.402602201015625*^9}, {3.402602658984375*^9, 
   3.4026026681875*^9}, {3.40260305734375*^9, 3.4026031309375*^9}, {
   3.402603161953125*^9, 3.40260325196875*^9}, 3.402857302921875*^9, 
   3.402857370234375*^9}],

Cell["\<\
This function will project the cube state to a grid state. The projection \
direction is the second input.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4026036856875*^9, 3.402603700359375*^9}, {
   3.402604473203125*^9, 3.402604505453125*^9}, 3.402857302921875*^9, 
   3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProjectState", "[", 
    RowBox[{"cube_", ",", "ind_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "grid", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"grid", "=", "cube"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"grid", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"grid", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "ind"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "grid", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "grid", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4026045891875*^9, 3.40260460278125*^9}, {
   3.402604701953125*^9, 3.402604751140625*^9}, {3.402604805484375*^9, 
   3.4026048106875*^9}, {3.4026065735*^9, 3.4026065746875*^9}, 
   3.402857302921875*^9, 3.402857370234375*^9}],

Cell["\<\
This function will give the Maslov (homological) grading for a cube diagram \
state. Two projection directions must be included.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402604976421875*^9, 3.402605026078125*^9}, 
   3.402857302921875*^9, 3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CubeMaslov", "[", 
    RowBox[{
    "state_", ",", "link1_", ",", "link2_", ",", "proj1_", ",", "proj2_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Maslov", "[", 
     RowBox[{
      RowBox[{"ProjectState", "[", 
       RowBox[{"state", ",", "proj1"}], "]"}], ",", "link1"}], "]"}], "+", 
    RowBox[{"Maslov", "[", 
     RowBox[{
      RowBox[{"ProjectState", "[", 
       RowBox[{"state", ",", "proj2"}], "]"}], ",", "link2"}], "]"}]}]}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.40260503571875*^9, 3.402605082375*^9}, {
   3.40260512465625*^9, 3.40260520840625*^9}, {3.402606792984375*^9, 
   3.402606801203125*^9}, {3.402700311828125*^9, 3.40270033775*^9}, 
   3.402857302921875*^9, 3.402857370234375*^9}],

Cell["\<\
This function will give the Alexander (polynomial) grading for a cube diagram \
state. Two projection directions must be included.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402605338984375*^9, 3.40260534096875*^9}, {
   3.4026054009375*^9, 3.402605424171875*^9}, 3.402857302921875*^9, 
   3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CubeAlexander", "[", 
    RowBox[{
    "state_", ",", "link1_", ",", "link2_", ",", "proj1_", ",", "proj2_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Alexander", "[", 
     RowBox[{
      RowBox[{"ProjectState", "[", 
       RowBox[{"state", ",", "proj1"}], "]"}], ",", "link1"}], "]"}], "+", 
    RowBox[{"Alexander", "[", 
     RowBox[{
      RowBox[{"ProjectState", "[", 
       RowBox[{"state", ",", "proj2"}], "]"}], ",", "link2"}], "]"}]}]}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4026054284375*^9, 3.4026054528125*^9}, {
   3.402605569984375*^9, 3.40260563240625*^9}, {3.402606804375*^9, 
   3.4026068125*^9}, {3.40260686628125*^9, 3.402606874140625*^9}, 
   3.402857302921875*^9, 3.402857370234375*^9}],

Cell["\<\
This function will give partition the states for a cube diagram according to \
Alexander filtration level.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402605860609375*^9, 3.402605911640625*^9}, 
   3.402857302921875*^9, 3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CubeAlexFilter", "[", 
    RowBox[{"link_", ",", "proj1_", ",", "proj2_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "statelist", ",", "alexcom", ",", "alexcnt", ",", "alexind", ",", 
       "templist", ",", "link1", ",", "link2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"statelist", "=", 
       RowBox[{"CubeStates", "[", 
        RowBox[{"Length", "[", 
         RowBox[{"link", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"alexcom", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"link1", "=", 
       RowBox[{"ProjectCubeDiagram", "[", 
        RowBox[{"link", ",", "proj1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"link2", "=", 
       RowBox[{"ProjectCubeDiagram", "[", 
        RowBox[{"link", ",", "proj2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"alexcnt", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"templist", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"statelist", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"CubeAlexander", "[", 
            RowBox[{
            "#", ",", "link1", ",", "link2", ",", "proj1", ",", "proj2"}], 
            "]"}], "\[Equal]", "0"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"templist", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"alexcom", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"alexcom", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "templist"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"alexcnt", "=", 
          RowBox[{"alexcnt", "+", 
           RowBox[{"Length", "[", "templist", "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"alexind", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"alexcnt", "<", 
         RowBox[{"Length", "[", "statelist", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"templist", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"statelist", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"CubeAlexander", "[", 
               RowBox[{
               "#", ",", "link1", ",", "link2", ",", "proj1", ",", "proj2"}], 
               "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{"1", "/", "2"}], "*", "alexind"}]}], "&"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"templist", "\[NotEqual]", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"alexcom", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"alexcom", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"1", "/", "2"}], "*", "alexind"}], ",", 
                 "templist"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"alexcnt", "=", 
             RowBox[{"alexcnt", "+", 
              RowBox[{"Length", "[", "templist", "]"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"templist", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"statelist", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"CubeAlexander", "[", 
               RowBox[{
               "#", ",", "link1", ",", "link2", ",", "proj1", ",", "proj2"}], 
               "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "/", "2"}], "*", "alexind"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"templist", "\[NotEqual]", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"alexcom", "=", 
             RowBox[{"Prepend", "[", 
              RowBox[{"alexcom", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "1"}], "/", "2"}], "*", "alexind"}], ",", 
                 "templist"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"alexcnt", "=", 
             RowBox[{"alexcnt", "+", 
              RowBox[{"Length", "[", "templist", "]"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"alexind", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "alexcom", "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4026061791875*^9, 3.402606263828125*^9}, {
   3.40260682790625*^9, 3.402606857890625*^9}, {3.40260695078125*^9, 
   3.40260700590625*^9}, 3.402857302921875*^9, 3.402857370234375*^9}],

Cell["\<\
This function will generate the chain complex for a cube diagram.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402607215921875*^9, 3.402607243578125*^9}, 
   3.402857302921875*^9, 3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CubeComplex", "[", 
    RowBox[{"link_", ",", "proj1_", ",", "proj2_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "chncom", ",", "alexfil", ",", "templist", ",", "masind", ",", "mascnt",
        ",", "tempmas", ",", "link1", ",", "link2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"alexfil", "=", 
       RowBox[{"CubeAlexFilter", "[", 
        RowBox[{"link", ",", "proj1", ",", "proj2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"chncom", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"link1", "=", 
       RowBox[{"ProjectCubeDiagram", "[", 
        RowBox[{"link", ",", "proj1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"link2", "=", 
       RowBox[{"ProjectCubeDiagram", "[", 
        RowBox[{"link", ",", "proj2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"mascnt", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"chncom", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"chncom", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"alexfil", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"templist", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"alexfil", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"CubeMaslov", "[", 
               RowBox[{
               "#", ",", "link1", ",", "link2", ",", "proj1", ",", "proj2"}], 
               "]"}], "\[Equal]", "0"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"templist", "\[NotEqual]", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{"printmarkers", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<i= \>\"", ",", "i", ",", 
                 "\"\<, Adding states, Maslov: \>\"", ",", "0"}], "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"chncom", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"chncom", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "templist"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"mascnt", "=", 
             RowBox[{"mascnt", "+", 
              RowBox[{"Length", "[", "templist", "]"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"masind", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"mascnt", "<", 
            RowBox[{"Length", "[", 
             RowBox[{"alexfil", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"templist", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"alexfil", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"CubeMaslov", "[", 
                  RowBox[{
                  "#", ",", "link1", ",", "link2", ",", "proj1", ",", 
                   "proj2"}], "]"}], "\[Equal]", "masind"}], "&"}]}], "]"}]}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"templist", "\[NotEqual]", 
               RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{"printmarkers", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\<i= \>\"", ",", "i", ",", 
                    "\"\<, Adding states, Maslov: \>\"", ",", "masind"}], 
                   "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"chncom", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"chncom", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"masind", ",", "templist"}], "}"}]}], "]"}]}], ";",
                "\[IndentingNewLine]", 
               RowBox[{"mascnt", "=", 
                RowBox[{"mascnt", "+", 
                 RowBox[{"Length", "[", "templist", "]"}]}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"templist", "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"alexfil", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"CubeMaslov", "[", 
                  RowBox[{
                  "#", ",", "link1", ",", "link2", ",", "proj1", ",", 
                   "proj2"}], "]"}], "\[Equal]", 
                 RowBox[{"-", "masind"}]}], "&"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"templist", "\[NotEqual]", 
               RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{"printmarkers", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\<i= \>\"", ",", "i", ",", 
                    "\"\<, Adding states, Maslov: \>\"", ",", "masind"}], 
                   "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"chncom", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
                RowBox[{"Prepend", "[", 
                 RowBox[{
                  RowBox[{"chncom", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "masind"}], ",", "templist"}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"mascnt", "=", 
                RowBox[{"mascnt", "+", 
                 RowBox[{"Length", "[", "templist", "]"}]}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"masind", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "alexfil", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "chncom", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402607353828125*^9, 3.40260735590625*^9}, {
   3.402607437640625*^9, 3.40260745565625*^9}, {3.40260755759375*^9, 
   3.402607585421875*^9}, {3.402607623078125*^9, 3.402607686640625*^9}, {
   3.402608117828125*^9, 3.40260811996875*^9}, {3.4027781810625*^9, 
   3.402778199203125*^9}, {3.402778312140625*^9, 3.402778453484375*^9}, {
   3.402778653515625*^9, 3.4027786635*^9}, 3.4028573029375*^9, 
   3.402857370234375*^9, {3.445025404711298*^9, 3.4450254490246067`*^9}}],

Cell["\<\
This function will normalize the grid diagram for a link so that the point s \
is at the origin. Also, it will rewrite the state so that s is at the origin, \
and it will rewrite the coordinates of t with respect to s as the new origin.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402666825*^9, 3.40266690428125*^9}, 3.4028573029375*^9, 
   3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ShiftDiagram", "[", 
    RowBox[{"link_", ",", "state_", ",", "s_", ",", "t_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"newstate", ",", "newlink", ",", "newt", ",", "n"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"link", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newlink", "=", "link"}], ";", "\[IndentingNewLine]", 
      RowBox[{"newt", "=", "t"}], ";", "\[IndentingNewLine]", 
      RowBox[{"newstate", "=", "state"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"newstate", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"state", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", 
               RowBox[{"s", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ",", "n"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"newlink", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "i", ",", "k"}], "]"}], "]"}], "=", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"link", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "i", ",", "k"}], "]"}], "]"}], "-", 
                 RowBox[{"s", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], ",", "n"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"k", ",", "2"}], "}"}]}], "\[IndentingNewLine]", 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"newt", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"t", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", 
            RowBox[{"s", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", "n"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"newlink", ",", "newstate", ",", "newt"}], "}"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.40266692065625*^9, 3.40266702746875*^9}, {
   3.402667280390625*^9, 3.402667287296875*^9}, {3.402667427421875*^9, 
   3.40266746140625*^9}, {3.402667530296875*^9, 3.402667545890625*^9}, {
   3.40266757684375*^9, 3.4026676771875*^9}, {3.402667762484375*^9, 
   3.4026677684375*^9}, {3.402667804296875*^9, 3.40266781128125*^9}, {
   3.40266804215625*^9, 3.402668043265625*^9}, {3.402668161203125*^9, 
   3.402668162015625*^9}, 3.4028573029375*^9, 3.402857370234375*^9}],

Cell["\<\
This function will output a value of True if there is an empty rectangle \
between the points s and t of the state for a plane link diagram. If there is \
no empty rectangle, it outputs False.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402670199453125*^9, 3.40267022090625*^9}, {
   3.402670280453125*^9, 3.402670300671875*^9}, {3.402670336375*^9, 
   3.402670348453125*^9}, 3.4028573029375*^9, 3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EmptyRectangle", "[", 
    RowBox[{"link_", ",", "state_", ",", "s_", ",", "t_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"empt", ",", "norm"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"empt", "=", "True"}], ";", "\[IndentingNewLine]", 
      RowBox[{"norm", "=", 
       RowBox[{"ShiftDiagram", "[", 
        RowBox[{"link", ",", "state", ",", "s", ",", "t"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"norm", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "i", ",", "j", ",", "1"}], "]"}], "]"}], 
              "<", 
              RowBox[{"norm", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "&&", 
             RowBox[{
              RowBox[{"norm", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "i", ",", "j", ",", "2"}], "]"}], "]"}], 
              "<", 
              RowBox[{"norm", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "2"}], "]"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"empt", "=", "False"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"norm", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "i"}], "]"}], "]"}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"norm", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"norm", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "i"}], "]"}], "]"}], "\[NotEqual]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"norm", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "i", ",", "1"}], "]"}], "]"}], "<", 
               RowBox[{"norm", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "&&", 
              RowBox[{
               RowBox[{"norm", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "i", ",", "2"}], "]"}], "]"}], "<", 
               RowBox[{"norm", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", "2"}], "]"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"empt", "=", "False"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"norm", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "empt", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4026703506875*^9, 3.40267040546875*^9}, {
   3.40267044965625*^9, 3.402670466109375*^9}, {3.4026717095*^9, 
   3.40267174671875*^9}, {3.402672070515625*^9, 3.402672241375*^9}, {
   3.402674692328125*^9, 3.4026747166875*^9}, 3.4028573029375*^9, 
   3.402857370234375*^9}],

Cell["\<\
This function will give the state corresponding changing the first \
coordinates of s with t and vice versa.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402673750625*^9, 3.402673784828125*^9}, 
   3.4028573029375*^9, 3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DiffState", "[", 
     RowBox[{"state_", ",", "i_", ",", "j_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "diffstate", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"diffstate", "=", "state"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"diffstate", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"state", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"state", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"diffstate", "[", 
         RowBox[{"[", "j", "]"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"state", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"state", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "diffstate", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402673513203125*^9, 3.40267373784375*^9}, {
   3.40267417275*^9, 3.40267424646875*^9}, {3.402674374046875*^9, 
   3.402674384390625*^9}, 3.402857302953125*^9, 3.402857370234375*^9}],

Cell["\<\
This function will be the differential for the plane grid diagram. It will \
output a list of states, each one a summand of the output.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402672807875*^9, 3.402672830328125*^9}, {
   3.402672874140625*^9, 3.402672883203125*^9}, 3.402857302953125*^9, 
   3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PlaneDiff", "[", 
    RowBox[{"link_", ",", "state_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"difflist", ",", "diffstate"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"difflist", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"EmptyRectangle", "[", 
              RowBox[{"link", ",", "state", ",", 
               RowBox[{"state", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"state", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "||", 
             RowBox[{"EmptyRectangle", "[", 
              RowBox[{"link", ",", "state", ",", 
               RowBox[{"state", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"state", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"difflist", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"difflist", ",", 
                RowBox[{"DiffState", "[", 
                 RowBox[{"state", ",", "i", ",", "j"}], "]"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"i", "+", "1"}], ",", 
            RowBox[{"Length", "[", "state", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "state", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "difflist", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402672992140625*^9, 3.402673014015625*^9}, {
   3.402673317484375*^9, 3.402673459671875*^9}, {3.402673842828125*^9, 
   3.40267385365625*^9}, {3.40267390025*^9, 3.402673975578125*^9}, {
   3.40267401528125*^9, 3.402674022421875*^9}, {3.40267414534375*^9, 
   3.40267415865625*^9}, {3.402674270515625*^9, 3.402674314828125*^9}, 
   3.402675018*^9, {3.40267540528125*^9, 3.402675405640625*^9}, 
   3.402857302953125*^9, 3.402857370234375*^9}],

Cell["\<\
This function will take two states in the projections and build a state in \
the cube diagram.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402675031046875*^9, 3.40267505209375*^9}, {
   3.402675098796875*^9, 3.402675100546875*^9}, 3.402857302953125*^9, 
   3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProjToCube", "[", 
    RowBox[{"state1_", ",", "state2_", ",", "proj1_", ",", "proj2_"}], "]"}], 
   ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "cubestate", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"proj1", ",", "proj2"}], "}"}], "\[Equal]", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}], "||", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"proj1", ",", "proj2"}], "}"}], "\[Equal]", 
          RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cubestate", "=", "state1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"cubestate", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"cubestate", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"state2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "cubestate", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"proj1", ",", "proj2"}], "}"}], "\[Equal]", 
          RowBox[{"{", 
           RowBox[{"2", ",", "1"}], "}"}]}], "||", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"proj1", ",", "proj2"}], "}"}], "\[Equal]", 
          RowBox[{"{", 
           RowBox[{"3", ",", "1"}], "}"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cubestate", "=", "state2"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"cubestate", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"cubestate", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"state1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "cubestate", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"proj1", ",", "proj2"}], "}"}], "\[Equal]", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cubestate", "=", "state2"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"cubestate", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"cubestate", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"state1", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "cubestate", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"proj1", ",", "proj2"}], "}"}], "\[Equal]", 
         RowBox[{"{", 
          RowBox[{"3", ",", "2"}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cubestate", "=", "state1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"cubestate", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"cubestate", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"state2", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "cubestate", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "cubestate", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.40267510503125*^9, 3.402675128015625*^9}, {
   3.402675160125*^9, 3.4026751915625*^9}, {3.4026753181875*^9, 
   3.40267532315625*^9}, {3.402675434578125*^9, 3.4026755115625*^9}, {
   3.402675591625*^9, 3.402675669703125*^9}, {3.402675735515625*^9, 
   3.402675811625*^9}, {3.402675869984375*^9, 3.402676087328125*^9}, {
   3.40267615821875*^9, 3.402676165375*^9}, {3.4026762866875*^9, 
   3.402676287921875*^9}, 3.40267664428125*^9, 3.402857302953125*^9, 
   3.402857370234375*^9}],

Cell["\<\
This function will compute the differential of  a state in the cube diagram. \
The output will be a list of states, each one a summand in the differential.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402676771578125*^9, 3.402676798359375*^9}, 
   3.402857302953125*^9, 3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CubeDiff", "[", 
    RowBox[{"link_", ",", "state_", ",", "proj1_", ",", "proj2_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "link1", ",", "link2", ",", "state1", ",", "state2", ",", "difflist", 
       ",", "difflist1", ",", "difflist2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"link1", "=", 
       RowBox[{"ProjectCubeDiagram", "[", 
        RowBox[{"link", ",", "proj1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"link2", "=", 
       RowBox[{"ProjectCubeDiagram", "[", 
        RowBox[{"link", ",", "proj2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state1", "=", 
       RowBox[{"ProjectState", "[", 
        RowBox[{"state", ",", "proj1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state2", "=", 
       RowBox[{"ProjectState", "[", 
        RowBox[{"state", ",", "proj2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"difflist1", "=", 
       RowBox[{"PlaneDiff", "[", 
        RowBox[{"link1", ",", "state1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"difflist2", "=", 
       RowBox[{"PlaneDiff", "[", 
        RowBox[{"link2", ",", "state2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"difflist", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"difflist", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"difflist", ",", 
           RowBox[{"ProjToCube", "[", 
            RowBox[{
             RowBox[{"difflist1", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "state2", ",", "proj1", 
             ",", "proj2"}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "difflist1", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"difflist", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"difflist", ",", 
           RowBox[{"ProjToCube", "[", 
            RowBox[{"state1", ",", 
             RowBox[{"difflist2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "proj1", ",", "proj2"}], 
            "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "difflist2", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "difflist", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.40267722784375*^9, 3.40267724090625*^9}, {
   3.402677413734375*^9, 3.40267742715625*^9}, {3.40267755728125*^9, 
   3.4026776221875*^9}, {3.402677864796875*^9, 3.40267811478125*^9}, 
   3.402857302953125*^9, 3.402857370234375*^9}],

Cell["\<\
This function will take two states and return True if they are equal and \
False if they are not equal.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402678389859375*^9, 3.402678432078125*^9}, 
   3.402857302953125*^9, 3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StateEqual", "[", 
    RowBox[{"state1_", ",", "state2_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"newstate1", ",", "newstate2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newstate1", "=", 
       RowBox[{"OrderCoordinates", "[", "state1", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newstate2", "=", 
       RowBox[{"OrderCoordinates", "[", "state2", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"newstate1", "\[Equal]", "newstate2"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "True", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Return", "[", "False", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.40267843584375*^9, 3.402678448828125*^9}, {
   3.402679635078125*^9, 3.40267965815625*^9}, {3.40267990471875*^9, 
   3.402679954921875*^9}, 3.402857302953125*^9, 3.402857370234375*^9}],

Cell["\<\
This function will compute the boundary matrix for a cube diagram.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4026801269375*^9, 3.402680165546875*^9}, {
   3.40268043190625*^9, 3.402680436078125*^9}, {3.402680602546875*^9, 
   3.402680617171875*^9}, 3.402857302953125*^9, 3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CubeBoundMatrix", "[", 
    RowBox[{
    "link_", ",", "dom_", ",", "codom_", ",", "proj1_", ",", "proj2_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"difflist", ",", "bndmat", ",", "zerovect"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"zerovect", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"zerovect", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"zerovect", ",", "0"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Length", "[", "codom", "]"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"bndmat", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"bndmat", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"bndmat", ",", "zerovect"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Length", "[", "dom", "]"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"difflist", "=", 
          RowBox[{"CubeDiff", "[", 
           RowBox[{"link", ",", 
            RowBox[{"dom", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "proj1", ",", "proj2"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"StateEqual", "[", 
                RowBox[{
                 RowBox[{"difflist", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"codom", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"bndmat", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "k"}], "]"}], "]"}], "=", "1"}], ";"}]}],
               "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"Length", "[", "codom", "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", "difflist", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "dom", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "bndmat", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4026806198125*^9, 3.40268065065625*^9}, {
   3.40268077165625*^9, 3.4026808704375*^9}, {3.40268107690625*^9, 
   3.40268111071875*^9}, {3.402681244125*^9, 3.4026814375*^9}, 
   3.402857302953125*^9, 3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CubeDiffRank", "[", 
    RowBox[{
    "link_", ",", "dom_", ",", "codom_", ",", "proj1_", ",", "proj2_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rank", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"dom", "\[Equal]", 
          RowBox[{"{", "}"}]}], "||", 
         RowBox[{"codom", "\[Equal]", 
          RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"rank", "=", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rank", "=", 
          RowBox[{"MatrixRank", "[", 
           RowBox[{
            RowBox[{"CubeBoundMatrix", "[", 
             RowBox[{
             "link", ",", "dom", ",", "codom", ",", "proj1", ",", "proj2"}], 
             "]"}], ",", 
            RowBox[{"Modulus", "\[Rule]", "2"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "rank", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402692348265625*^9, 3.402692379546875*^9}, {
   3.402692521796875*^9, 3.402692557875*^9}, {3.40269267321875*^9, 
   3.402692743796875*^9}, {3.402787060625*^9, 3.402787083640625*^9}, {
   3.402787400796875*^9, 3.402787423890625*^9}, 3.40285730296875*^9, 
   3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CubeBetti", "[", 
    RowBox[{
    "first_", ",", "second_", ",", "third_", ",", "link_", ",", "proj1_", ",",
      "proj2_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Length", "[", "second", "]"}], "-", 
    RowBox[{"CubeDiffRank", "[", 
     RowBox[{
     "link", ",", "first", ",", "second", ",", "proj1", ",", "proj2"}], "]"}],
     "-", 
    RowBox[{"CubeDiffRank", "[", 
     RowBox[{
     "link", ",", "second", ",", "third", ",", "proj1", ",", "proj2"}], 
     "]"}]}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402691827234375*^9, 3.4026919050625*^9}, {
   3.40269204640625*^9, 3.4026920760625*^9}, {3.402692236015625*^9, 
   3.40269232453125*^9}, {3.402692810078125*^9, 3.4026928175*^9}, {
   3.40269284878125*^9, 3.4026929530625*^9}, 3.40285730296875*^9, 
   3.402857370234375*^9}],

Cell["\<\
This function will compute the homology of a cube diagram. The first two \
numbers are the min and max Alexander filtration levels, and the second two \
numbers are the min and max Maslov gradings. The fifth entry is the homology \
matrix.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4026903721875*^9, 3.40269039740625*^9}, {
   3.4026904301875*^9, 3.40269047040625*^9}, {3.402690522890625*^9, 
   3.402690536640625*^9}, 3.40285730296875*^9, 3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CubeHomology", "[", 
    RowBox[{"link_", ",", "proj1_", ",", "proj2_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "chncmp", ",", "homcomp", ",", "minalex", ",", "maxalex", ",", "minmas",
        ",", "maxmas", ",", "zerovect", ",", "homrank", ",", "masind"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"chncmp", "=", 
       RowBox[{"CubeComplex", "[", 
        RowBox[{"link", ",", "proj1", ",", "proj2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"minalex", "=", 
       RowBox[{"chncmp", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"maxalex", "=", 
       RowBox[{"chncmp", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Length", "[", "chncmp", "]"}], ",", "1"}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"minmas", "=", 
       RowBox[{"chncmp", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxmas", "=", 
       RowBox[{"chncmp", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Length", "[", "chncmp", "]"}], ",", "2", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"chncmp", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Length", "[", "chncmp", "]"}], ",", "2"}], "]"}], 
            "]"}], "]"}], ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"printmarkers", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Min Alex: \>\"", ",", "minalex"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Max Alex: \>\"", ",", "maxalex"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Min Maslov: \>\"", ",", "minmas"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Max Maslov: \>\"", ",", "maxalex"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "chncmp", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"zerovect", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"homcomp", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"zerovect", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"zerovect", ",", "0"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"maxmas", "-", "minmas", "+", "1"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"homcomp", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"homcomp", ",", "zerovect"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"maxalex", "-", "minalex", "+", "1"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"chncmp", "=", 
       RowBox[{"AddEmptyMaslovGrades", "[", "chncmp", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"printmarkers", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<homology matrix: \>\"", ",", 
           RowBox[{"MatrixForm", "[", "homcomp", "]"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"masind", "=", 
          RowBox[{
           RowBox[{"chncmp", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2", ",", "2", ",", "1"}], "]"}], "]"}], "-", 
           "minmas", "+", "1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"printmarkers", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<masind: \>\"", ",", "masind"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{"printmarkers", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<CubeBetti arguments: \>\"", ",", 
                 RowBox[{"chncmp", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2", ",", 
                    RowBox[{"j", "+", "1"}], ",", "2"}], "]"}], "]"}], ",", 
                 "\"\< ,\>\"", ",", " ", 
                 RowBox[{"chncmp", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2", ",", "j", ",", "2"}], "]"}], "]"}], 
                 ",", "\"\< and \>\"", ",", " ", 
                 RowBox[{"chncmp", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2", ",", 
                    RowBox[{"j", "-", "1"}], ",", "2"}], "]"}], "]"}]}], 
                "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"homrank", "=", 
             RowBox[{"CubeBetti", "[", 
              RowBox[{
               RowBox[{"chncmp", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2", ",", 
                  RowBox[{"j", "+", "1"}], ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{"chncmp", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2", ",", "j", ",", "2"}], "]"}], "]"}], 
               ",", 
               RowBox[{"chncmp", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2", ",", 
                  RowBox[{"j", "-", "1"}], ",", "2"}], "]"}], "]"}], ",", 
               "link", ",", "proj1", ",", "proj2"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"printmarkers", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<homrank: \>\"", ",", "homrank"}], "]"}], ";"}]}],
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"homcomp", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "masind"}], "]"}], "]"}], "=", "homrank"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"masind", "++"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"j", ",", "2", ",", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"chncmp", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "-", "1"}]}], 
            "}"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "chncmp", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"minalex", ",", "maxalex", ",", "minmas", ",", "maxmas", ",", 
         RowBox[{"MatrixForm", "[", "homcomp", "]"}]}], "}"}], "]"}], ";"}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402690556296875*^9, 3.40269065084375*^9}, {
   3.4026906834375*^9, 3.402690693640625*^9}, 3.4026908004375*^9, {
   3.402690953453125*^9, 3.402690996*^9}, {3.402691053078125*^9, 
   3.40269116221875*^9}, {3.402691247125*^9, 3.402691280484375*^9}, {
   3.4026914306875*^9, 3.402691468046875*^9}, {3.402691533625*^9, 
   3.402691560484375*^9}, {3.40269159646875*^9, 3.4026916125625*^9}, {
   3.40269165134375*^9, 3.4026916554375*^9}, {3.402691712296875*^9, 
   3.402691739453125*^9}, {3.40269304115625*^9, 3.40269304396875*^9}, {
   3.4026986401875*^9, 3.402698735359375*^9}, {3.402698796953125*^9, 
   3.40269884621875*^9}, {3.402699075078125*^9, 3.402699075640625*^9}, {
   3.4026992270625*^9, 3.402699230609375*^9}, {3.402699288*^9, 
   3.40269929290625*^9}, {3.40269936203125*^9, 3.4026993781875*^9}, {
   3.402699409265625*^9, 3.402699652484375*^9}, {3.402699736859375*^9, 
   3.40269976846875*^9}, {3.40269991328125*^9, 3.402699928640625*^9}, {
   3.4026999760625*^9, 3.402700082578125*^9}, {3.402779836796875*^9, 
   3.40277986996875*^9}, {3.402780066203125*^9, 3.402780083625*^9}, {
   3.40278044678125*^9, 3.402780451109375*^9}, {3.40278056940625*^9, 
   3.4027805695*^9}, {3.40278163421875*^9, 3.4027816451875*^9}, {
   3.40278171971875*^9, 3.402781721890625*^9}, {3.402784236421875*^9, 
   3.402784275640625*^9}, {3.402784984890625*^9, 3.4027849859375*^9}, {
   3.402785243875*^9, 3.40278526290625*^9}, {3.402785345921875*^9, 
   3.40278538225*^9}, {3.4027855811875*^9, 3.402785617390625*^9}, {
   3.402785696890625*^9, 3.402785714875*^9}, {3.40278624225*^9, 
   3.402786350765625*^9}, {3.402786496859375*^9, 3.402786547578125*^9}, 
   3.40285730296875*^9, 3.402857370234375*^9, {3.445020335598564*^9, 
   3.445020340119899*^9}, {3.4450254546203547`*^9, 3.4450255290497704`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AddEmptyMaslovGrades", "[", "comp_", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "newcomp", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newcomp", "=", "comp"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"newcomp", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"newcomp", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newcomp", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"newcomp", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}]}], "}"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "newcomp", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "newcomp", "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402782691578125*^9, 3.402782710765625*^9}, {
   3.402783287046875*^9, 3.402783295140625*^9}, {3.4027839116875*^9, 
   3.402784035265625*^9}, 3.40285730296875*^9, 3.402857370234375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProjectCubeDiagramNew", "[", 
    RowBox[{"cube_", ",", "proj_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"plane", ",", "newplane"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"plane", "=", "cube"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"plane", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
            RowBox[{"Delete", "[", 
             RowBox[{
              RowBox[{"plane", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "proj"}], "]"}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"plane", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"plane", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"OrderCoordinates", "[", 
           RowBox[{"plane", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"proj", "\[Equal]", "1"}], ",", 
        RowBox[{"plane", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"plane", ",", "2"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"proj", "\[Equal]", "2"}], ",", 
        RowBox[{"plane", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"plane", ",", "3"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"proj", "\[Equal]", "3"}], ",", 
        RowBox[{
         RowBox[{"plane", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"plane", ",", "1"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"newplane", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"X", "[", "]"}], ",", 
         RowBox[{"Y", "[", "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"newplane", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "=", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"newplane", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"plane", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i"}], "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newplane", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "=", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"newplane", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"plane", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "i"}], "]"}], "]"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"plane", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "newplane", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.402598210828125*^9, 3.402598227546875*^9}, {
   3.40259831021875*^9, 3.40259831078125*^9}, {3.402598597640625*^9, 
   3.40259860584375*^9}, {3.402599833765625*^9, 3.402599848375*^9}, {
   3.40259998775*^9, 3.402600014140625*^9}, {3.402600473234375*^9, 
   3.402600553703125*^9}, {3.402600602625*^9, 3.40260065659375*^9}, {
   3.402600765015625*^9, 3.402600789609375*^9}, {3.40260112546875*^9, 
   3.402601128296875*^9}, {3.402601272015625*^9, 3.402601319578125*^9}, {
   3.402601430375*^9, 3.402601515203125*^9}, 3.402601929859375*^9, 
   3.402830587953125*^9, 3.40283069903125*^9, {3.4410484275209417`*^9, 
   3.4410485034750385`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Draw3DLink", "[", "link_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "boollink", ",", "ptmatrix", ",", "current", ",", "index", ",", "pt", 
       ",", "markind", ",", "graphiclist", ",", "n", ",", "basepoint"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"boollink", "=", "link"}], ";", "\[IndentingNewLine]", 
      RowBox[{"graphiclist", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ptmatrix", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"boollink", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"boollink", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "False"}], "}"}]}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"boollink", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "boollink", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"index", "=", 
       RowBox[{"FindFirstMark", "[", "boollink", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"index", "\[NotEqual]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"current", "=", 
          RowBox[{"boollink", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"index", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"index", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"boollink", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"index", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"index", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], "]"}], "=", 
          "True"}], ";", "\[IndentingNewLine]", 
         RowBox[{"ptmatrix", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"ptmatrix", ",", 
            RowBox[{"{", "current", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"index", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pt", "=", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"FindNextMark", "[", 
                RowBox[{"current", ",", 
                 RowBox[{"boollink", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], ";"}]}],
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"index", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pt", "=", 
             RowBox[{"{", 
              RowBox[{"3", ",", 
               RowBox[{"FindNextMark", "[", 
                RowBox[{"current", ",", 
                 RowBox[{"boollink", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}]}], ";"}]}],
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"index", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "3"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pt", "=", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"FindNextMark", "[", 
                RowBox[{"current", ",", 
                 RowBox[{"boollink", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}]}], ";"}]}],
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"boollink", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"pt", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"pt", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
            "\[NotEqual]", "current"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ptmatrix", "[", 
              RowBox[{"[", 
               RowBox[{"Length", "[", "ptmatrix", "]"}], "]"}], "]"}], "=", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"ptmatrix", "[", 
                RowBox[{"[", 
                 RowBox[{"Length", "[", "ptmatrix", "]"}], "]"}], "]"}], ",", 
               RowBox[{"boollink", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"pt", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"pt", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "]"}]}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"boollink", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"pt", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"pt", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], "]"}], 
             "=", "True"}], ";", "\[IndentingNewLine]", 
            RowBox[{"markind", "=", 
             RowBox[{"pt", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"markind", "\[Equal]", "1"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"pt", "=", 
                RowBox[{"{", 
                 RowBox[{"2", ",", 
                  RowBox[{"FindNextMark", "[", 
                   RowBox[{
                    RowBox[{"boollink", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pt", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pt", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"boollink", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"markind", "\[Equal]", "2"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"pt", "=", 
                RowBox[{"{", 
                 RowBox[{"3", ",", 
                  RowBox[{"FindNextMark", "[", 
                   RowBox[{
                    RowBox[{"boollink", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pt", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pt", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"boollink", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}]}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"markind", "\[Equal]", "3"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"pt", "=", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"FindNextMark", "[", 
                   RowBox[{
                    RowBox[{"boollink", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pt", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"pt", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"boollink", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}]}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"index", "=", 
          RowBox[{"FindFirstMark", "[", "boollink", "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ptmatrix", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"ptmatrix", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"ptmatrix", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "ptmatrix", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"graphiclist", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"graphiclist", ",", 
             RowBox[{"Cylinder", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ptmatrix", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                 RowBox[{"ptmatrix", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"1", "/", "4"}]}], "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"ptmatrix", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "ptmatrix", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"graphiclist", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"graphiclist", ",", 
             RowBox[{"Sphere", "[", 
              RowBox[{
               RowBox[{"link", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
               RowBox[{"1", "/", "4"}]}], "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"link", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"graphiclist", "=", 
       RowBox[{"Prepend", "[", 
        RowBox[{"graphiclist", ",", 
         RowBox[{"EdgeForm", "[", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"link", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"basepoint", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", 
              RowBox[{"n", "/", "10"}]}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"n", "/", "10"}], ",", "0"}], "}"}]}], "}"}], "]"}], 
         ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"n", "/", "10"}], ",", "0", ",", "0"}], "}"}]}], "}"}], 
          "]"}], ",", 
         RowBox[{"Sphere", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"n", "/", "10"}], ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"n", "/", "30"}]}], "]"}], ",", 
         RowBox[{"Sphere", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"n", "/", "10"}], ",", "0"}], "}"}], ",", 
           RowBox[{"n", "/", "50"}]}], "]"}], ",", 
         RowBox[{"Sphere", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"n", "/", "10"}]}], "}"}], ",", 
           RowBox[{"n", "/", "70"}]}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"graphiclist", "=", 
       RowBox[{"Prepend", "[", 
        RowBox[{"graphiclist", ",", "basepoint"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{"graphiclist", ",", 
         RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.44502618154751*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProjectToDrawing", "[", 
    RowBox[{"link_", ",", "proj_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"grid", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"grid", "=", "link"}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"link", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"proj", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"grid", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "=", 
               RowBox[{"n", "-", 
                RowBox[{"grid", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"grid", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"grid", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"grid", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "3"}], "]"}], "]"}]}], 
                "}"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"grid", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "grid", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"proj", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"grid", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"grid", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"grid", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j", ",", "3"}], "]"}], "]"}]}], "}"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"grid", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "grid", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"proj", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"grid", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"grid", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"grid", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}]}], "}"}]}],
               ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"grid", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "=", 
               RowBox[{"n", "-", 
                RowBox[{"grid", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}]}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"grid", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "grid", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"grid", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", 
         RowBox[{"grid", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"grid", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"grid", ",", "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"grid", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"grid", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"grid", "=", 
            RowBox[{"Delete", "[", 
             RowBox[{"grid", ",", "3"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"grid", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], "\[Equal]", 
               RowBox[{"grid", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"grid", "=", 
                RowBox[{"Delete", "[", 
                 RowBox[{"grid", ",", "2"}], "]"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "grid", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.445026181547574*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DrawLinkProjection", "[", 
    RowBox[{"link_", ",", "proj_", ",", "grid_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gridgraphics", ",", "n", ",", "linkproj", ",", "intlist", ",", "plist",
        ",", "auglist", ",", "linkgraphics", ",", "allgraphics", ",", 
       "oldproj"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"link", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"linkgraphics", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gridgraphics", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"grid", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"gridgraphics", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"gridgraphics", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", 
                    RowBox[{"i", "-", "1"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"n", ",", 
                    RowBox[{"i", "-", "1"}]}], "}"}]}], "}"}], "]"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"gridgraphics", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"gridgraphics", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "n"}], "}"}]}], "}"}], 
                "]"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"n", "+", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"proj", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"gridgraphics", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"gridgraphics", ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"n", "-", "1"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"n", "-", 
                    RowBox[{"3", "/", "4"}]}], ",", 
                    RowBox[{"1", "/", "8"}]}], "}"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"n", "-", "1"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"n", "-", 
                    RowBox[{"3", "/", "4"}]}], ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "8"}]}], "}"}]}], "}"}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"n", "-", 
                    RowBox[{"1", "/", "8"}]}], ",", 
                    RowBox[{"3", "/", "4"}]}], "}"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"n", "+", 
                    RowBox[{"1", "/", "8"}]}], ",", 
                    RowBox[{"3", "/", "4"}]}], "}"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", 
                  RowBox[{"\"\<y\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"n", "-", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "5"}]}], "}"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", 
                  RowBox[{"\"\<z\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"n", "+", 
                    RowBox[{"1", "/", "5"}]}], ",", 
                    RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], "}"}]}], 
              "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"proj", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"gridgraphics", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"gridgraphics", ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "/", "8"}], ",", 
                    RowBox[{"3", "/", "4"}]}], "}"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "8"}], ",", 
                    RowBox[{"3", "/", "4"}]}], "}"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"3", "/", "4"}], ",", 
                    RowBox[{"1", "/", "8"}]}], "}"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"3", "/", "4"}], ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "8"}]}], "}"}]}], "}"}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", 
                  RowBox[{"\"\<x\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "5"}]}], "}"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", 
                  RowBox[{"\"\<z\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "5"}], ",", 
                    RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], "}"}]}], 
              "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"proj", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"gridgraphics", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"gridgraphics", ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"n", "-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "/", "8"}], ",", 
                    RowBox[{"n", "-", 
                    RowBox[{"3", "/", "4"}]}]}], "}"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"n", "-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "8"}], ",", 
                    RowBox[{"n", "-", 
                    RowBox[{"3", "/", "4"}]}]}], "}"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "n"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"3", "/", "4"}], ",", 
                    RowBox[{"n", "+", 
                    RowBox[{"1", "/", "8"}]}]}], "}"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "n"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"3", "/", "4"}], ",", 
                    RowBox[{"n", "-", 
                    RowBox[{"1", "/", "8"}]}]}], "}"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", 
                  RowBox[{"\"\<x\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"n", "+", 
                    RowBox[{"1", "/", "5"}]}]}], "}"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Text", "[", 
                  RowBox[{"\"\<y\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "5"}], ",", 
                    RowBox[{"n", "-", 
                    RowBox[{"1", "/", "2"}]}]}], "}"}]}], "]"}]}], "}"}]}], 
              "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"linkproj", "=", 
       RowBox[{"ProjectToDrawing", "[", 
        RowBox[{"link", ",", "proj"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"intlist", "=", 
       RowBox[{"FindIntersectionPoints", "[", "linkproj", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plist", "=", 
       RowBox[{"CreatePartnerList", "[", "linkproj", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"auglist", "=", 
       RowBox[{"ResolveAllIntersections", "[", 
        RowBox[{
        "plist", ",", "intlist", ",", "link", ",", "proj", ",", "linkproj"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"linkgraphics", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"linkgraphics", ",", 
            RowBox[{"CreateHorizLineSegment", "[", 
             RowBox[{"linkproj", ",", 
              RowBox[{"auglist", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "i"}], "]"}], "]"}]}], "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"linkgraphics", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"linkgraphics", ",", 
            RowBox[{"CreateVertLineSegment", "[", 
             RowBox[{"linkproj", ",", 
              RowBox[{"auglist", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "i"}], "]"}], "]"}]}], "]"}]}], "]"}]}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"auglist", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"gridgraphics", "=", 
       RowBox[{"{", 
        RowBox[{"Black", ",", "gridgraphics"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"linkgraphics", "=", 
       RowBox[{"{", 
        RowBox[{"Blue", ",", "linkgraphics"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allgraphics", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"gridgraphics", ",", "linkgraphics"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Graphics", "[", "allgraphics", "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.445026181547627*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateHorizLineSegment", "[", 
     RowBox[{"linkproj_", ",", "list_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"endpoint1", ",", "endpoint2", ",", "line"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"line", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"linkproj", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", 
             RowBox[{"list", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "]"}], "<", 
          RowBox[{"linkproj", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", 
             RowBox[{"list", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "]"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"endpoint1", "=", 
           RowBox[{"linkproj", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"endpoint2", "=", 
           RowBox[{"linkproj", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"endpoint1", "=", 
           RowBox[{"linkproj", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"endpoint2", "=", 
           RowBox[{"linkproj", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "list", "]"}], "\[Equal]", "2"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"line", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"line", ",", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{"endpoint1", ",", "endpoint2"}], "}"}], "]"}]}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"line", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"line", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{"endpoint1", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"list", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", 
                   RowBox[{"1", "/", "4"}]}], ",", 
                  RowBox[{"endpoint1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"line", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"line", ",", "\[IndentingNewLine]", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{"endpoint2", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"Length", "[", "list", "]"}], "]"}], "]"}], "+", 
                   RowBox[{"1", "/", "4"}]}], ",", 
                  RowBox[{"endpoint1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"line", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"line", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", 
                    RowBox[{"1", "/", "4"}]}], ",", 
                    RowBox[{"endpoint1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"1", "/", "4"}]}], ",", 
                    RowBox[{"endpoint1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
               "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "3", ",", 
              RowBox[{
               RowBox[{"Length", "[", "list", "]"}], "-", "1"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "line", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.445025857884811*^9, 3.445025872157724*^9}, 
   3.4450261815477037`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CreateVertLineSegment", "[", 
    RowBox[{"linkproj_", ",", "list_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"endpoint1", ",", "endpoint2", ",", "line"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"line", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"linkproj", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", 
            RowBox[{"list", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], "]"}], "<", 
         RowBox[{"linkproj", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", 
            RowBox[{"list", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"endpoint1", "=", 
          RowBox[{"linkproj", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", 
             RowBox[{"list", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"endpoint2", "=", 
          RowBox[{"linkproj", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", 
             RowBox[{"list", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"endpoint1", "=", 
          RowBox[{"linkproj", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", 
             RowBox[{"list", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"endpoint2", "=", 
          RowBox[{"linkproj", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", 
             RowBox[{"list", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "list", "]"}], "\[Equal]", "2"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"line", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"line", ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{"endpoint1", ",", "endpoint2"}], "}"}], "]"}]}], "]"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"line", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"line", ",", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{"endpoint1", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"endpoint1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"list", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "-", 
                  RowBox[{"1", "/", "4"}]}]}], "}"}]}], "}"}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"line", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"line", ",", "\[IndentingNewLine]", 
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{"endpoint2", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"endpoint1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"list", "[", 
                   RowBox[{"[", 
                    RowBox[{"Length", "[", "list", "]"}], "]"}], "]"}], "+", 
                  RowBox[{"1", "/", "4"}]}]}], "}"}]}], "}"}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"line", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"line", ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"endpoint1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", 
                    RowBox[{"1", "/", "4"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"endpoint1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"1", "/", "4"}]}]}], "}"}]}], "}"}], "]"}]}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "3", ",", 
             RowBox[{
              RowBox[{"Length", "[", "list", "]"}], "-", "1"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "line", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.445026181547762*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindPlaceInPartnerList", "[", 
    RowBox[{"pt_", ",", "list_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ind", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "list", "]"}], "\[Equal]", "2"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ind", "=", "3"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"pt", "<", 
            RowBox[{"list", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"ind", "=", "3"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"list", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "<", "pt"}], "&&", 
                 RowBox[{"pt", "<", 
                  RowBox[{"list", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ind", "=", 
                  RowBox[{"i", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"i", ",", "3", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "list", "]"}], "-", "1"}]}], "}"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "list", "]"}], "\[Equal]", "3"}], "&&", 
               RowBox[{"pt", "<", 
                RowBox[{"list", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"ind", "=", "3"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"pt", ">", 
               RowBox[{"list", "[", 
                RowBox[{"[", 
                 RowBox[{"Length", "[", "list", "]"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"ind", "=", 
                RowBox[{
                 RowBox[{"Length", "[", "list", "]"}], "+", "1"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "ind", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.4450261815478153`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindInPartnerList", "[", 
    RowBox[{"plist_", ",", "pair_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ind", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"plist", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"pair", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
           RowBox[{
            RowBox[{"plist", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Equal]", 
            RowBox[{"pair", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ind", "=", "i"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "plist", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "ind", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.445026181547867*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PointOfIntersection", "[", 
     RowBox[{"int_", ",", "linkproj_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"linkproj", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", 
         RowBox[{"int", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"linkproj", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", 
         RowBox[{"int", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], "]"}]}], "}"}]}],
    ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.44502618154792*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindHorizontalSegment", "[", 
    RowBox[{"seg_", ",", "link_", ",", "proj_", ",", "linkproj_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"point1", ",", "point2", ",", "ind", ",", "Llist", ",", "hor"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"point1", "=", 
       RowBox[{"linkproj", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", 
          RowBox[{"seg", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"point2", "=", 
       RowBox[{"linkproj", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", 
          RowBox[{"seg", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Llist", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"proj", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ind", "=", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ind", "=", "3"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"link", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "ind"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"point1", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Llist", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"Llist", ",", 
                RowBox[{"link", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"link", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Llist", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "proj"}], "]"}], "]"}], "\[Equal]", 
         RowBox[{"Llist", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "proj"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"hor", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Llist", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"Llist", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Llist", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "proj"}], "]"}], "]"}], "\[Equal]", 
         RowBox[{"Llist", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "proj"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"hor", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Llist", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"Llist", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Llist", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "proj"}], "]"}], "]"}], "\[Equal]", 
         RowBox[{"Llist", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "proj"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"hor", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Llist", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"Llist", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "hor", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.445026181547971*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindVerticalSegment", "[", 
    RowBox[{"seg_", ",", "link_", ",", "proj_", ",", "linkproj_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "point1", ",", "point2", ",", "ind", ",", "Llist", ",", "vert"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"point1", "=", 
       RowBox[{"linkproj", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", 
          RowBox[{"seg", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"point2", "=", 
       RowBox[{"linkproj", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", 
          RowBox[{"seg", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Llist", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"proj", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ind", "=", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ind", "=", "1"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"link", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "ind"}], "]"}], "]"}], "\[Equal]", 
             RowBox[{"point1", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Llist", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"Llist", ",", 
                RowBox[{"link", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"link", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Llist", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "proj"}], "]"}], "]"}], "\[Equal]", 
         RowBox[{"Llist", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "proj"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vert", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Llist", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"Llist", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Llist", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "proj"}], "]"}], "]"}], "\[Equal]", 
         RowBox[{"Llist", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "proj"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vert", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Llist", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"Llist", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Llist", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "proj"}], "]"}], "]"}], "\[Equal]", 
         RowBox[{"Llist", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "proj"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"vert", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Llist", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"Llist", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "vert", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.445026181548023*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SegmentIntersect", "[", 
    RowBox[{"line1_", ",", "line2_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "bool", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bool", "=", "False"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"line1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", 
          RowBox[{"line2", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&&", 
         RowBox[{
          RowBox[{"line1", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"line2", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&&", 
         RowBox[{
          RowBox[{"line1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "<", 
          RowBox[{"line2", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "&&", 
         RowBox[{
          RowBox[{"line1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], ">", 
          RowBox[{"line2", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bool", "=", "True"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"line1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"line2", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"line1", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "<", 
          RowBox[{"line2", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"line1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "<", 
          RowBox[{"line2", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"line1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], ">", 
          RowBox[{"line2", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bool", "=", "True"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"line1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"line2", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"line1", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], "<", 
          RowBox[{"line2", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"line1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], ">", 
          RowBox[{"line2", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"line1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "<", 
          RowBox[{"line2", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bool", "=", "True"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"line1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", 
          RowBox[{"line2", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"line1", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"line2", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"line1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], ">", 
          RowBox[{"line2", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"line1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "<", 
          RowBox[{"line2", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bool", "=", "True"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "bool", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.4450261815481157`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindHorizPartner", "[", 
    RowBox[{"mark_", ",", "linkproj_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "partner", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"linkproj", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "i", ",", "2"}], "]"}], "]"}], "\[Equal]", 
           RowBox[{"linkproj", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "mark", ",", "2"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"partner", "=", "i"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"linkproj", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "partner", "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.445026181548169*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindVertPartner", "[", 
    RowBox[{"mark_", ",", "linkproj_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "partner", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"linkproj", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "i", ",", "1"}], "]"}], "]"}], "\[Equal]", 
           RowBox[{"linkproj", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "mark", ",", "1"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"partner", "=", "i"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"linkproj", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "partner", "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.445026181548224*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CreatePartnerList", "[", "linkproj_", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"plist", ",", "partner"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"plist", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"plist", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "=", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"plist", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"FindHorizPartner", "[", 
               RowBox[{"i", ",", "linkproj"}], "]"}]}], "}"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"plist", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "=", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"plist", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"FindVertPartner", "[", 
               RowBox[{"i", ",", "linkproj"}], "]"}]}], "}"}]}], "]"}]}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"linkproj", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "plist", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.403224628578125*^9, 3.40322480425*^9}, 
   3.403236342640625*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindNextMark", "[", 
    RowBox[{"mark_", ",", "array_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "index", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"mark", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
              RowBox[{"array", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}]}], "&&", 
             RowBox[{
              RowBox[{"mark", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
              RowBox[{"array", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}]}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"mark", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
              RowBox[{"array", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}]}], "&&", 
             RowBox[{
              RowBox[{"mark", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
              RowBox[{"array", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1", ",", "3"}], "]"}], "]"}]}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"mark", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
              RowBox[{"array", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}]}], "&&", 
             RowBox[{
              RowBox[{"mark", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
              RowBox[{"array", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1", ",", "3"}], "]"}], "]"}]}]}], ")"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"index", "=", "i"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "array", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "index", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.403217785328125*^9, 3.403217821484375*^9}, {
   3.40321788284375*^9, 3.403218075828125*^9}, 3.403236342640625*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindFirstMark", "[", "bool_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"index", ",", "test", ",", "ind1", ",", "ind2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"test", "=", "False"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ind1", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"index", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"test", "\[Equal]", "False"}], "&&", 
         RowBox[{"ind1", "<", "4"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ind2", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"test", "\[Equal]", "False"}], "&&", 
            RowBox[{"ind2", "<", 
             RowBox[{"Length", "[", 
              RowBox[{"bool", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"bool", "[", 
                RowBox[{"[", 
                 RowBox[{"ind1", ",", "ind2", ",", "2"}], "]"}], "]"}], 
               "\[Equal]", "False"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"index", "=", 
                RowBox[{"{", 
                 RowBox[{"ind1", ",", "ind2"}], "}"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"test", "=", "True"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"ind2", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"ind1", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "index", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.403218331609375*^9, 3.4032183719375*^9}, {
   3.4032184199375*^9, 3.40321857821875*^9}, {3.4032186231875*^9, 
   3.403218669640625*^9}, {3.403218718453125*^9, 3.403218722484375*^9}, 
   3.403236342640625*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FromNewToOldLinkProj", "[", 
    RowBox[{"linkproj_", ",", "proj_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"newproj", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"linkproj", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newproj", "=", "linkproj"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"proj", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"newproj", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], "=", 
              RowBox[{"n", "-", 
               RowBox[{"newproj", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"newproj", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "newproj", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"proj", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"newproj", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "=", 
              RowBox[{"n", "-", 
               RowBox[{"newproj", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"newproj", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "newproj", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "newproj", "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.40379729525*^9, 3.403797317953125*^9}, {
   3.40379737403125*^9, 3.4037973779375*^9}, {3.403797416*^9, 
   3.403797422546875*^9}, {3.40379748078125*^9, 3.403797617546875*^9}, {
   3.4038022749375*^9, 3.4038023278125*^9}, {3.403803262171875*^9, 
   3.40380326775*^9}, 3.4038064105625*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DrawStateOnLinkProj", "[", 
     RowBox[{"link_", ",", "proj_", ",", "state_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"stategraphics", ",", "linkgraphics"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"stategraphics", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"proj", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"stategraphics", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"stategraphics", ",", 
               RowBox[{"Disk", "[", 
                RowBox[{
                 RowBox[{"state", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"1", "/", "8"}]}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "state", "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"proj", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"stategraphics", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"stategraphics", ",", 
               RowBox[{"Disk", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "state", "]"}], "-", 
                    RowBox[{"state", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
                   RowBox[{"state", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"1", "/", "8"}]}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "state", "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"proj", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"stategraphics", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"stategraphics", ",", "\[IndentingNewLine]", 
               RowBox[{"Disk", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"state", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"Length", "[", "state", "]"}], "-", 
                    RowBox[{"state", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
                 RowBox[{"1", "/", "8"}]}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "state", "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"linkgraphics", "=", 
        RowBox[{"DrawLinkProjection", "[", 
         RowBox[{"link", ",", "proj", ",", "True"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"linkgraphics", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "stategraphics"}], "}"}], 
         "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.40538588534375*^9, 3.4053859630625*^9}, {
   3.40538608009375*^9, 3.405386106796875*^9}, {3.4053861528125*^9, 
   3.405386173296875*^9}, {3.405386256984375*^9, 3.40538651478125*^9}, {
   3.40538655315625*^9, 3.4053865786875*^9}, {3.405386623*^9, 
   3.405386697234375*^9}, {3.40538677828125*^9, 3.40538680534375*^9}, {
   3.405386842515625*^9, 3.40538692421875*^9}, {3.4053869675*^9, 
   3.405387013484375*^9}, 3.405387082015625*^9, 3.4054267615625*^9, 
   3.405426835890625*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DrawDiffStates", "[", 
     RowBox[{"link_", ",", "proj_", ",", "state_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dstates", ",", "basegraphics", ",", "dgraph", ",", "allgraph"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"basegraphics", "=", 
        RowBox[{"DrawStateOnLinkProj", "[", 
         RowBox[{"link", ",", "proj", ",", "state"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dstates", "=", 
        RowBox[{"PlaneDiff", "[", 
         RowBox[{
          RowBox[{"ProjectCubeDiagram", "[", 
           RowBox[{"link", ",", "proj"}], "]"}], ",", "state"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"dgraph", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"proj", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"dgraph", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"dgraph", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"dgraph", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "=", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"dgraph", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"Disk", "[", 
                   RowBox[{
                    RowBox[{"dstates", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                    RowBox[{"1", "/", "8"}]}], "]"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"dstates", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
              "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "dstates", "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"proj", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"dgraph", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"dgraph", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"dgraph", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "=", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"dgraph", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"Disk", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"dstates", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "-", 
                    RowBox[{"dstates", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}]}], ",", 
                    RowBox[{"dstates", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}]}], "}"}], 
                    ",", 
                    RowBox[{"1", "/", "8"}]}], "]"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"dstates", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
              "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "dstates", "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"proj", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"dgraph", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"dgraph", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"dgraph", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "=", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"dgraph", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"Disk", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"dstates", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"dstates", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "-", 
                    RowBox[{"dstates", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}]}]}], 
                    "}"}], ",", 
                    RowBox[{"1", "/", "8"}]}], "]"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"dstates", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
              "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "dstates", "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"allgraph", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"allgraph", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"allgraph", ",", 
            RowBox[{"Graphics", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"basegraphics", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"Red", ",", 
                 RowBox[{"dgraph", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "dgraph", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "allgraph", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.405387166765625*^9, 3.405387286734375*^9}, {
   3.40538732471875*^9, 3.405387742125*^9}, {3.405387785265625*^9, 
   3.40538786875*^9}, {3.40538791096875*^9, 3.405387912375*^9}, {
   3.405387957609375*^9, 3.40538797403125*^9}, {3.40538804296875*^9, 
   3.405388137171875*^9}, 3.4054267615625*^9, 3.405426835890625*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomLink", "[", "n_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "link", ",", "xrowlist", ",", "xcollist", ",", "rowran", ",", "colran", 
       ",", "ybool", ",", "yplace", ",", "randlist", ",", "ylist"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xrowlist", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xcollist", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"randlist", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"link", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"X", "[", "]"}], ",", 
         RowBox[{"Y", "[", "]"}], ",", 
         RowBox[{"Z", "[", "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"randlist", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"randlist", ",", "i"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"xrowlist", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"xrowlist", ",", "i"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"xcollist", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"xcollist", ",", "i"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"SeedRandom", "[", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"rowran", "=", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"n", "-", "i", "+", "1"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SeedRandom", "[", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"colran", "=", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"n", "-", "i", "+", "1"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"link", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "=", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"link", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xcollist", "[", 
               RowBox[{"[", "colran", "]"}], "]"}], ",", 
              RowBox[{"xrowlist", "[", 
               RowBox[{"[", "rowran", "]"}], "]"}], ",", "i"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"xcollist", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"xcollist", ",", "colran"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"xrowlist", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"xrowlist", ",", "rowran"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ybool", "=", 
       RowBox[{"RandomInteger", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ylist", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "ylist", "]"}], "<", "n"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ylist", "=", 
          RowBox[{"PlaceY", "[", "link", "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"link", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "=", "ylist"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"link", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", 
       RowBox[{"PlaceZ", "[", "link", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"link", "=", 
       RowBox[{"ShiftLink", "[", "link", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "link", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.40336558759375*^9, 3.40336561415625*^9}, {
   3.40336586371875*^9, 3.4033659815*^9}, {3.403366019046875*^9, 
   3.403366033109375*^9}, {3.403366156609375*^9, 3.403366162859375*^9}, {
   3.403366235609375*^9, 3.403366445046875*^9}, {3.4033665063125*^9, 
   3.403366516578125*^9}, {3.403366553734375*^9, 3.40336655390625*^9}, {
   3.40336663203125*^9, 3.403366633375*^9}, {3.40336666615625*^9, 
   3.403366681375*^9}, {3.403367294296875*^9, 3.403367366046875*^9}, {
   3.403367535453125*^9, 3.4033675583125*^9}, {3.40336760903125*^9, 
   3.403367635640625*^9}, {3.403367683109375*^9, 3.403367742046875*^9}, {
   3.4033677884375*^9, 3.403367865375*^9}, {3.403368380359375*^9, 
   3.403368425671875*^9}, {3.403372402125*^9, 3.40337241453125*^9}, {
   3.40337344834375*^9, 3.403373470046875*^9}, {3.40337499865625*^9, 
   3.403375019171875*^9}, {3.403375057375*^9, 3.4033750775*^9}, {
   3.403375148828125*^9, 3.403375157015625*^9}, {3.403375781125*^9, 
   3.403375781921875*^9}, {3.403375867625*^9, 3.403375882203125*^9}, {
   3.403377994421875*^9, 3.40337800925*^9}, 3.4033813855625*^9, {
   3.440684422203125*^9, 3.44068442675*^9}, {3.44070584*^9, 
   3.44070584221875*^9}, {3.443734156074987*^9, 3.443734156880641*^9}, {
   3.443736161603304*^9, 3.443736162598215*^9}, {3.443736241655457*^9, 
   3.443736250542632*^9}, {3.443736289799543*^9, 3.443736298046446*^9}, {
   3.4437363821534443`*^9, 3.443736383135393*^9}, {3.4437364337794113`*^9, 
   3.443736446414104*^9}, {3.443736532948968*^9, 3.44373653547929*^9}, {
   3.443736788254229*^9, 3.443736792866087*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PlaceY", "[", "partial_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ylist1", ",", "yplace", ",", "n", ",", "randlist", ",", "placelist", 
       ",", "ycoord"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"randlist", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"partial", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"randlist", ",", "i"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ylist1", "=", 
       RowBox[{"Y", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"yplace", "=", 
          RowBox[{"partial", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"placelist", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"randlist", ",", 
            RowBox[{"Position", "[", 
             RowBox[{"randlist", ",", 
              RowBox[{"yplace", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"placelist", "\[NotEqual]", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SeedRandom", "[", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"ycoord", "=", 
             RowBox[{"RandomInteger", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"Length", "[", "placelist", "]"}]}], "}"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"yplace", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "=", 
             RowBox[{"placelist", "[", 
              RowBox[{"[", "ycoord", "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"randlist", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{"randlist", ",", 
               RowBox[{"Position", "[", 
                RowBox[{"randlist", ",", 
                 RowBox[{"placelist", "[", 
                  RowBox[{"[", "ycoord", "]"}], "]"}]}], "]"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"ylist1", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"ylist1", ",", "yplace"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "ylist1", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.403370084890625*^9, 3.403370086671875*^9}, {
   3.40337013478125*^9, 3.403370201484375*^9}, {3.40337035971875*^9, 
   3.40337038459375*^9}, {3.403370521078125*^9, 3.4033705520625*^9}, {
   3.403370876953125*^9, 3.4033709551875*^9}, {3.40337100196875*^9, 
   3.40337102359375*^9}, {3.403371392453125*^9, 3.403371400671875*^9}, {
   3.403371470875*^9, 3.403371472375*^9}, {3.403371539453125*^9, 
   3.4033715701875*^9}, {3.403371658*^9, 3.403371766984375*^9}, {
   3.403371925984375*^9, 3.403371977734375*^9}, {3.403372069796875*^9, 
   3.403372144734375*^9}, {3.403372203265625*^9, 3.4033722765625*^9}, {
   3.403372343390625*^9, 3.403372344484375*^9}, {3.40337245753125*^9, 
   3.4033724595*^9}, {3.40337267328125*^9, 3.40337273159375*^9}, {
   3.4033728123125*^9, 3.403372831796875*^9}, {3.403372961375*^9, 
   3.403372981*^9}, {3.403373883515625*^9, 3.4033739396875*^9}, {
   3.403374041984375*^9, 3.40337406396875*^9}, {3.40337413359375*^9, 
   3.403374160375*^9}, 3.403375136046875*^9, {3.403375173609375*^9, 
   3.40337533984375*^9}, {3.40337546771875*^9, 3.403375482796875*^9}, {
   3.40337567678125*^9, 3.40337576578125*^9}, {3.40337584228125*^9, 
   3.403375853125*^9}, {3.40337598275*^9, 3.40337628075*^9}, {
   3.40337776028125*^9, 3.40337780953125*^9}, {3.40337784109375*^9, 
   3.403377872359375*^9}, {3.4033780159375*^9, 3.40337803871875*^9}, {
   3.403378080203125*^9, 3.40337810821875*^9}, {3.403378226171875*^9, 
   3.4033782683125*^9}, 3.4033813855625*^9, {3.443744022717432*^9, 
   3.443744035648808*^9}, {3.4437440667237177`*^9, 3.443744067359213*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PlaceZ", "[", "partial_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"link", ",", "xmark", ",", "ymark", ",", "zlist", ",", "n"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"partial", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"zlist", "=", 
       RowBox[{"Z", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"partial", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "j", ",", "3"}], "]"}], "]"}], "\[Equal]", 
               "i"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"xmark", "=", 
                RowBox[{"partial", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "j"}], "]"}], "]"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"partial", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "j", ",", "3"}], "]"}], "]"}], "\[Equal]", 
               "i"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"ymark", "=", 
                RowBox[{"partial", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "j"}], "]"}], "]"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"j", ",", "n"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"zlist", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xmark", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"ymark", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "i"}], "}"}]}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "zlist", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.4437441148652897`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Commutation", "[", 
    RowBox[{"link_", ",", "coord_", ",", "first_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"newlink", ",", "n", ",", "goup", ",", "godown"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"link", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newlink", "=", "link"}], ";", "\[IndentingNewLine]", 
      RowBox[{"goup", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"godown", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "\[LessEqual]", "first"}], "&&", 
         RowBox[{"first", "<", "n"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"newlink", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "coord"}], "]"}], "]"}], 
                 "\[Equal]", 
                 RowBox[{"first", "-", 
                  RowBox[{"1", "/", "2"}]}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"goup", ",", "j"}], "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"newlink", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "coord"}], "]"}], "]"}], 
                 "\[Equal]", 
                 RowBox[{"first", "+", 
                  RowBox[{"1", "/", "2"}]}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"godown", ",", "j"}], "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"j", ",", "n"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "3"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"newlink", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"goup", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "coord"}], "]"}], "]"}],
              "=", 
             RowBox[{"first", "+", 
              RowBox[{"1", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"newlink", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"godown", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "coord"}], "]"}], "]"}],
              "=", 
             RowBox[{"first", "-", 
              RowBox[{"1", "/", "2"}]}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "3"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"GoodCube", "[", 
         RowBox[{"newlink", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "newlink", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Return", "[", "link", "]"}], ";"}]}], "\[IndentingNewLine]",
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.443744114865418*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DrawRandomLinks", "[", 
     RowBox[{"num_", ",", "size_", ",", "fixed_", ",", "showlink_"}], "]"}], ":=",
     "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"returnlist", ",", "link"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"returnlist", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"fixed", ",", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"link", "=", 
             RowBox[{"RandomLink", "[", "size", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"showlink", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"returnlist", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"returnlist", ",", 
                  RowBox[{"UnShiftLink", "[", "link", "]"}]}], "]"}]}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"returnlist", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"returnlist", ",", 
               RowBox[{"Draw3DLink", "[", "link", "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"returnlist", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"returnlist", ",", 
               RowBox[{"DrawLinkProjection", "[", 
                RowBox[{"link", ",", "1", ",", "True"}], "]"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"returnlist", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"returnlist", ",", 
               RowBox[{"DrawLinkProjection", "[", 
                RowBox[{"link", ",", "2", ",", "True"}], "]"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"returnlist", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"returnlist", ",", 
               RowBox[{"DrawLinkProjection", "[", 
                RowBox[{"link", ",", "3", ",", "True"}], "]"}]}], "]"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", "num", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"SeedRandom", "[", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"link", "=", 
              RowBox[{"RandomLink", "[", 
               RowBox[{"RandomInteger", "[", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "size"}], "}"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"showlink", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"returnlist", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{"returnlist", ",", 
                   RowBox[{"UnShiftLink", "[", "link", "]"}]}], "]"}]}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"returnlist", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"returnlist", ",", 
                RowBox[{"Draw3DLink", "[", "link", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"returnlist", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"returnlist", ",", 
                RowBox[{"DrawLinkProjection", "[", 
                 RowBox[{"link", ",", "1", ",", "True"}], "]"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"returnlist", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"returnlist", ",", 
                RowBox[{"DrawLinkProjection", "[", 
                 RowBox[{"link", ",", "2", ",", "True"}], "]"}]}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"returnlist", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"returnlist", ",", 
                RowBox[{"DrawLinkProjection", "[", 
                 RowBox[{"link", ",", "3", ",", "True"}], "]"}]}], "]"}]}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", "num", "}"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "returnlist", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.403380283625*^9, 3.403380303875*^9}, {
   3.40338041228125*^9, 3.4033804611875*^9}, {3.403380499953125*^9, 
   3.403380519671875*^9}, {3.40338055584375*^9, 3.4033807390625*^9}, {
   3.403380869203125*^9, 3.403381085125*^9}, {3.403381133109375*^9, 
   3.403381135796875*^9}, {3.40338122534375*^9, 3.403381262765625*^9}, 
   3.4033813855625*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GoodProjection", "[", "auglist_", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "good", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"good", "=", "True"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"auglist", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "j"}], "]"}], "]"}], "]"}], "\[NotEqual]", 
            "2"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"good", "=", "False"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"auglist", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "good", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4034411546870966`*^9, 3.403441185301957*^9}, {
   3.403441243562395*^9, 3.4034412615968766`*^9}, {3.403441329312134*^9, 
   3.4034413302810574`*^9}, {3.4034414221540217`*^9, 3.403441463425721*^9}, {
   3.4034414954148045`*^9, 3.40344151587094*^9}, 3.4034415464848204`*^9, {
   3.4034416206676135`*^9, 3.4034416502188377`*^9}, {3.4034424020939655`*^9, 
   3.4034424092042046`*^9}, 3.4034428736044188`*^9, {3.40363956075*^9, 
   3.403639597078125*^9}, {3.403639655015625*^9, 3.4036396574375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GoodLink", "[", "link_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "good", ",", "auglist", ",", "linkproj", ",", "plist", ",", "intlist"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"good", "=", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "True"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"linkproj", "=", 
          RowBox[{"ProjectCubeDiagram", "[", 
           RowBox[{"link", ",", "i"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"plist", "=", 
          RowBox[{"CreatePartnerList", "[", "linkproj", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"intlist", "=", 
          RowBox[{"FindIntersectionPoints", "[", "linkproj", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"auglist", "=", 
          RowBox[{"ResolveAllIntersections", "[", 
           RowBox[{
           "plist", ",", "intlist", ",", "link", ",", "i", ",", "linkproj"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"good", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"GoodProjection", "[", "auglist", "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"good", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&&", 
        RowBox[{"good", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "&&", 
        RowBox[{"good", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.403442344024076*^9, 3.403442358057361*^9}, {
   3.4034424145329776`*^9, 3.403442608212776*^9}, 3.4034428736044188`*^9, {
   3.4059409315625*^9, 3.405940935984375*^9}, {3.440778380300375*^9, 
   3.440778380706625*^9}, 3.440779096487875*^9, {3.4410452646433983`*^9, 
   3.4410452650652785`*^9}, {3.441046106138544*^9, 3.4410461127948794`*^9}, {
   3.4410478102161655`*^9, 3.4410478105599194`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"KnotInQ", "[", "linkinQuest_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "good", ",", "link", ",", "linklength", ",", "linkproj", ",", "plist", 
       ",", "intlist", ",", "hloc1", ",", "hloc2", ",", "hloc3", ",", "test", 
       ",", "testloc", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"good", "=", "False"}], ";", "\[IndentingNewLine]", 
      RowBox[{"link", "=", "linkinQuest"}], ";", "\[IndentingNewLine]", 
      RowBox[{"linklength", "=", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"link", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}], "*", "3"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"test", "=", 
       RowBox[{"link", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"testloc", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"link", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{"link", ",", "testloc"}], "]"}]}], ";", 
      RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"i", "<", "linklength"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"hloc1", "=", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"link", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"test", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"link", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"test", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"hloc2", "=", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"link", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "All", ",", "3"}], "]"}], "]"}], ",", 
              RowBox[{"test", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"link", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"test", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"hloc3", "=", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"link", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"test", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"link", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "All", ",", "3"}], "]"}], "]"}], ",", 
              RowBox[{"test", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "hloc1", "]"}], "!=", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"test", "=", 
             RowBox[{"link", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"hloc1", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"hloc1", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"testloc", "=", 
             RowBox[{"hloc1", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"link", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{"link", ",", "testloc"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "hloc2", "]"}], "!=", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"test", "=", 
                RowBox[{"link", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"hloc2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"hloc2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"testloc", "=", 
                RowBox[{"hloc2", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"link", "=", 
                RowBox[{"Delete", "[", 
                 RowBox[{"link", ",", "testloc"}], "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "hloc3", "]"}], "!=", "0"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"test", "=", 
                   RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"hloc3", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"hloc3", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"testloc", "=", 
                   RowBox[{"hloc3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"link", "=", 
                   RowBox[{"Delete", "[", 
                    RowBox[{"link", ",", "testloc"}], "]"}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}]}], "\[IndentingNewLine]", "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"i", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "linklength"}], ",", 
        RowBox[{"good", "=", "True"}], ",", 
        RowBox[{"good", "=", "False"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "good", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.403442344024076*^9, 3.403442358057361*^9}, {
   3.4034424145329776`*^9, 3.403442608212776*^9}, 3.4034428736044188`*^9, {
   3.4059409315625*^9, 3.405940935984375*^9}, {3.440778380300375*^9, 
   3.440778380706625*^9}, 3.440779096487875*^9, {3.4410452646433983`*^9, 
   3.4410452650652785`*^9}, {3.441046106138544*^9, 3.4410461127948794`*^9}, {
   3.4410478102161655`*^9, 3.4410478105599194`*^9}, {3.441285350930375*^9, 
   3.44128536891475*^9}, {3.441285456680375*^9, 3.44128547516475*^9}, {
   3.4412855810085*^9, 3.441285748196*^9}, {3.441285917961625*^9, 
   3.441285937571*^9}, {3.441285979196*^9, 3.441285980992875*^9}, {
   3.44128671166475*^9, 3.441286731524125*^9}, {3.441287277586625*^9, 
   3.441287343071*^9}, {3.441287389086625*^9, 3.441287408367875*^9}, {
   3.441287451742875*^9, 3.441287460680375*^9}, {3.441287510742875*^9, 
   3.441287779117875*^9}, {3.44128795847725*^9, 3.44128796647725*^9}, {
   3.44129200928975*^9, 3.441292011430375*^9}, {3.441292140680375*^9, 
   3.441292151242875*^9}, {3.4412921826335*^9, 3.441292260742875*^9}, {
   3.44129229841475*^9, 3.441292299149125*^9}, {3.441292421805375*^9, 
   3.4412924278835*^9}, {3.441292768836625*^9, 3.441292782180375*^9}, {
   3.4412929341335*^9, 3.44129302135225*^9}, {3.441293096336625*^9, 
   3.44129310266475*^9}, {3.44129329003975*^9, 3.441293293805375*^9}, {
   3.44129337522725*^9, 3.441293451774125*^9}, {3.4412935066335*^9, 
   3.441293517071*^9}, {3.441293549211625*^9, 3.441293612211625*^9}, {
   3.441293713055375*^9, 3.441293725117875*^9}, {3.441294420196*^9, 
   3.441294426946*^9}, {3.4412945455085*^9, 3.441294560899125*^9}, {
   3.44129562672725*^9, 3.441295631336625*^9}, {3.44129647891475*^9, 
   3.441296504992875*^9}, {3.4412967930085*^9, 3.4412968045085*^9}, {
   3.4412968360085*^9, 3.441296841696*^9}, {3.4412969716335*^9, 
   3.44129702866475*^9}, {3.441297078821*^9, 3.441297079617875*^9}, {
   3.44129712010225*^9, 3.44129712466475*^9}, {3.445026088611967*^9, 
   3.445026088945114*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GoodCube", "[", 
     RowBox[{"link_", ",", " ", "orient_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "good", ",", "auglist", ",", "linkproj", ",", "plist", ",", "intlist", 
        ",", "numXYZ", ",", "hloc1", ",", "hloc2", ",", "vloc1", ",", "vloc2",
         ",", "VerLineH", ",", "HorLineH", ",", "numInt", ",", "StdOrient", 
        ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"good", "=", 
        RowBox[{"{", 
         RowBox[{"True", ",", "True", ",", "True"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"numXYZ", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"link", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"StdOrient", "=", 
        RowBox[{"OddQ", "[", "orient", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"i", "<", "4"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"linkproj", "=", 
           RowBox[{"ProjectCubeDiagram", "[", 
            RowBox[{"link", ",", "i"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"plist", "=", 
           RowBox[{"CreatePartnerList", "[", "linkproj", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"intlist", "=", 
           RowBox[{"FindIntersectionPoints", "[", "linkproj", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"numInt", "=", 
           RowBox[{"Length", "[", "intlist", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "numInt", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"i", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"hloc1", "=", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "2"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
                    "]"}]}], "]"}], ",", 
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "3"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", "2"}], "]"}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"hloc2", "=", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "2"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}], ",", "1"}], "]"}], 
                    "]"}]}], "]"}], ",", 
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "3"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}], ",", "2"}], "]"}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "hloc1", "]"}], "\[Equal]", "1"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"HorLineH", "=", 
                  RowBox[{"link", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"hloc1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"hloc1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "1"}], "]"}], 
                   "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"HorLineH", "=", 
                  RowBox[{"link", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"hloc2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"hloc2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "1"}], "]"}], 
                   "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"vloc1", "=", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "2"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "3"}], "]"}], "]"}], ",", "1"}], "]"}], 
                    "]"}]}], "]"}], ",", 
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "3"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "3"}], "]"}], "]"}], ",", "2"}], "]"}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"vloc2", "=", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "2"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "4"}], "]"}], "]"}], ",", "1"}], "]"}], 
                    "]"}]}], "]"}], ",", 
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "3"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "4"}], "]"}], "]"}], ",", "2"}], "]"}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "vloc1", "]"}], "\[Equal]", "1"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"VerLineH", "=", 
                  RowBox[{"link", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vloc1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"vloc1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "1"}], "]"}], 
                   "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"VerLineH", "=", 
                  RowBox[{"link", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vloc2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"vloc2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "1"}], "]"}], 
                   "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"StdOrient", "\[Equal]", "True"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"VerLineH", ">", "HorLineH"}], ",", " ", 
                   RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "&&", "True"}]}], ",", 
                   RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "&&", "False"}]}]}], 
                  "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"VerLineH", " ", "<", " ", "HorLineH"}], ",", " ", 
                   RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "&&", "True"}]}], ",", 
                   " ", 
                   RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "&&", "False"}]}]}], 
                  "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"j", ",", "numInt"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"i", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"hloc1", "=", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "1"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
                    "]"}]}], "]"}], ",", 
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "3"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", "2"}], "]"}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"hloc2", "=", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "1"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}], ",", "1"}], "]"}], 
                    "]"}]}], "]"}], ",", 
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "3"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}], ",", "2"}], "]"}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "hloc1", "]"}], "\[Equal]", "1"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"HorLineH", "=", 
                  RowBox[{"link", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"hloc1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"hloc1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "2"}], "]"}], 
                   "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"HorLineH", "=", 
                  RowBox[{"link", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"hloc2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"hloc2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "2"}], "]"}], 
                   "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"vloc1", "=", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "1"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "3"}], "]"}], "]"}], ",", "1"}], "]"}], 
                    "]"}]}], "]"}], ",", 
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "3"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "3"}], "]"}], "]"}], ",", "2"}], "]"}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"vloc2", "=", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "1"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "4"}], "]"}], "]"}], ",", "1"}], "]"}], 
                    "]"}]}], "]"}], ",", 
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "3"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "4"}], "]"}], "]"}], ",", "2"}], "]"}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "vloc1", "]"}], "\[Equal]", "1"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"VerLineH", "=", 
                  RowBox[{"link", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vloc1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"vloc1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "2"}], "]"}], 
                   "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"VerLineH", "=", 
                  RowBox[{"link", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vloc2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"vloc2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "2"}], "]"}], 
                   "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"StdOrient", "\[Equal]", "True"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"VerLineH", "<", "HorLineH"}], ",", " ", 
                   RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "&&", "True"}]}], ",", 
                   RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "&&", "False"}]}]}], 
                  "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"VerLineH", " ", ">", " ", "HorLineH"}], ",", " ", 
                   RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "&&", "True"}]}], ",", 
                   " ", 
                   RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "&&", "False"}]}]}], 
                  "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"good", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], ","}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"j", ",", "numInt"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"i", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"hloc1", "=", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "1"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
                    "]"}]}], "]"}], ",", 
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "2"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", "2"}], "]"}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"hloc2", "=", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "1"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}], ",", "1"}], "]"}], 
                    "]"}]}], "]"}], ",", 
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "2"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2"}], "]"}], "]"}], ",", "2"}], "]"}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "hloc1", "]"}], "\[Equal]", "1"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"HorLineH", "=", 
                  RowBox[{"link", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"hloc1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"hloc1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "3"}], "]"}], 
                   "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"HorLineH", "=", 
                  RowBox[{"link", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"hloc2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"hloc2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "3"}], "]"}], 
                   "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"vloc1", "=", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "1"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "3"}], "]"}], "]"}], ",", "1"}], "]"}], 
                    "]"}]}], "]"}], ",", 
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "2"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "3"}], "]"}], "]"}], ",", "2"}], "]"}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"vloc2", "=", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "1"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "4"}], "]"}], "]"}], ",", "1"}], "]"}], 
                    "]"}]}], "]"}], ",", 
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"link", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "numXYZ"}], ",", "2"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"linkproj", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "4"}], "]"}], "]"}], ",", "2"}], "]"}], 
                    "]"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "vloc1", "]"}], "\[Equal]", "1"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"VerLineH", "=", 
                  RowBox[{"link", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vloc1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"vloc1", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "3"}], "]"}], 
                   "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"VerLineH", "=", 
                  RowBox[{"link", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"vloc2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"vloc2", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "3"}], "]"}], 
                   "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"StdOrient", "\[Equal]", "True"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"VerLineH", ">", "HorLineH"}], ",", " ", 
                   RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "&&", "True"}]}], ",", 
                   RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "&&", "False"}]}]}], 
                  "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"VerLineH", " ", "<", " ", "HorLineH"}], ",", " ", 
                   RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "&&", "True"}]}], ",", 
                   " ", 
                   RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"good", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "&&", "False"}]}]}], 
                  "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"j", ",", "numInt"}], "}"}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"good", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "False"}], ",", " ", 
            RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"i", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"good", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "&&", 
         RowBox[{"good", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "&&", 
         RowBox[{"good", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.403442344024076*^9, 3.403442358057361*^9}, {
   3.4034424145329776`*^9, 3.403442608212776*^9}, 3.4034428736044188`*^9, {
   3.4059409315625*^9, 3.405940935984375*^9}, {3.440778380300375*^9, 
   3.440778380706625*^9}, 3.440779096487875*^9, {3.4410416009693184`*^9, 
   3.4410416097819314`*^9}, 3.4410416423604736`*^9, {3.4410446963861246`*^9, 
   3.44104473901167*^9}, {3.4410453091127176`*^9, 3.441045338378717*^9}, 
   3.4410453718010197`*^9, {3.44104540187953*^9, 3.4410454044733133`*^9}, {
   3.4410454681928787`*^9, 3.441045472349182*^9}, {3.4410455024901924`*^9, 
   3.4410455068027477`*^9}, {3.441046115904294*^9, 3.441046209655494*^9}, {
   3.441047864560611*^9, 3.441047867170019*^9}, {3.4410487539001193`*^9, 
   3.4410487961819105`*^9}, {3.441211473938649*^9, 3.441211489891468*^9}, {
   3.441211522984583*^9, 3.4412115364843235`*^9}, {3.441214389514243*^9, 
   3.441214428716866*^9}, {3.441214495216015*^9, 3.4412146215737724`*^9}, 
   3.4412146542296047`*^9, {3.4412147854935493`*^9, 3.441214828680496*^9}, {
   3.4412148697580957`*^9, 3.4412149402103186`*^9}, {3.441215009553181*^9, 
   3.4412150304279137`*^9}, {3.4412150784272995`*^9, 
   3.4412151940664444`*^9}, {3.4412152297534876`*^9, 
   3.4412153419708014`*^9}, {3.441215387860839*^9, 3.4412154197823052`*^9}, {
   3.441215491968881*^9, 3.441215547577544*^9}, {3.441216612799425*^9, 
   3.4412166265337124`*^9}, {3.4412166725959177`*^9, 
   3.4412167132362823`*^9}, {3.44121696045345*^9, 3.4412170027031803`*^9}, {
   3.441217455497157*^9, 3.4412174563877764`*^9}, {3.4412175042468452`*^9, 
   3.4412175361841407`*^9}, {3.441217603449335*^9, 3.4412176346678853`*^9}, {
   3.4412177052143087`*^9, 3.441217705542432*^9}, {3.441217885525655*^9, 
   3.4412178879006395`*^9}, {3.4412179323378553`*^9, 
   3.4412179568376985`*^9}, {3.4412182742419167`*^9, 
   3.4412182770075245`*^9}, {3.441218343491474*^9, 3.4412183712256713`*^9}, {
   3.441218478771858*^9, 3.441218539583969*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FindIntersectionPoints", "[", "linkproj_", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intlist", ",", "plist"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"plist", "=", 
       RowBox[{"CreatePartnerList", "[", "linkproj", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"intlist", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SegmentIntersect", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"linkproj", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", 
                   RowBox[{"plist", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "i", ",", "1"}], "]"}], "]"}]}], "]"}], 
                 "]"}], ",", 
                RowBox[{"linkproj", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", 
                   RowBox[{"plist", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "i", ",", "2"}], "]"}], "]"}]}], "]"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"linkproj", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", 
                   RowBox[{"plist", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "j", ",", "1"}], "]"}], "]"}]}], "]"}], 
                 "]"}], ",", 
                RowBox[{"linkproj", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", 
                   RowBox[{"plist", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "j", ",", "2"}], "]"}], "]"}]}], "]"}], 
                 "]"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"intlist", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"intlist", ",", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"plist", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], ",", 
                  RowBox[{"plist", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "j"}], "]"}], "]"}]}], "]"}]}], "]"}]}],
              ";"}]}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"plist", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"plist", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "intlist", "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.403222761765625*^9, 3.403222777234375*^9}, {
   3.403222808296875*^9, 3.403222813375*^9}, {3.40322290078125*^9, 
   3.40322291571875*^9}, {3.403225014796875*^9, 3.403225031390625*^9}, {
   3.403226446390625*^9, 3.40322668634375*^9}, {3.403226866078125*^9, 
   3.403226872890625*^9}, {3.40322835778125*^9, 3.403228358109375*^9}, 
   3.403236342640625*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ResolveAllIntersections", "[", 
     RowBox[{
     "plist_", ",", "intlist_", ",", "link_", ",", "proj_", ",", 
      "linkproj_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newplist", ",", "resol", ",", "ind"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newplist", "=", "plist"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"resol", "=", 
           RowBox[{"ResolveIntersection", "[", 
            RowBox[{
             RowBox[{"intlist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "link", ",", "proj", ",", 
             "linkproj"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"resol", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ind", "=", 
              RowBox[{"FindInPartnerList", "[", 
               RowBox[{
                RowBox[{"plist", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"intlist", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
                  RowBox[{"intlist", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "4"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"newplist", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "ind"}], "]"}], "]"}], "=", 
              RowBox[{"Insert", "[", 
               RowBox[{
                RowBox[{"newplist", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "ind"}], "]"}], "]"}], ",", 
                RowBox[{"linkproj", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", 
                   RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "2"}], "]"}], 
                 "]"}], ",", 
                RowBox[{"FindPlaceInPartnerList", "[", 
                 RowBox[{
                  RowBox[{"linkproj", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "2"}], "]"}], 
                   "]"}], ",", 
                  RowBox[{"newplist", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "ind"}], "]"}], "]"}]}], "]"}]}], 
               "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"resol", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ind", "=", 
              RowBox[{"FindInPartnerList", "[", 
               RowBox[{
                RowBox[{"plist", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"intlist", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"intlist", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"newplist", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "ind"}], "]"}], "]"}], "=", 
              RowBox[{"Insert", "[", 
               RowBox[{
                RowBox[{"newplist", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "ind"}], "]"}], "]"}], ",", 
                RowBox[{"linkproj", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", 
                   RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", "1"}], "]"}], 
                 "]"}], ",", 
                RowBox[{"FindPlaceInPartnerList", "[", 
                 RowBox[{
                  RowBox[{"linkproj", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{"intlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", "1"}], "]"}], 
                   "]"}], ",", 
                  RowBox[{"newplist", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "ind"}], "]"}], "]"}]}], "]"}]}], 
               "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "intlist", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "newplist", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.403231748484375*^9, 3.403231887765625*^9}, {
   3.40323191990625*^9, 3.403232014171875*^9}, {3.403232136171875*^9, 
   3.403232164625*^9}, {3.403232203625*^9, 3.403232204703125*^9}, {
   3.403232266140625*^9, 3.4032323299375*^9}, {3.403232621546875*^9, 
   3.403232646515625*^9}, {3.403232942390625*^9, 3.403233220046875*^9}, {
   3.403233805859375*^9, 3.4032339175*^9}, {3.40323550371875*^9, 
   3.403235513828125*^9}, {3.403236288171875*^9, 3.403236294421875*^9}, 
   3.403236342640625*^9, {3.40338485759375*^9, 3.403384879859375*^9}, {
   3.403384923265625*^9, 3.40338493284375*^9}, {3.44078970078475*^9, 
   3.44078970115975*^9}, {3.440789734394125*^9, 3.44078975465975*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DrawRandomGoodLinks", "[", 
    RowBox[{
    "num_", ",", "size_", ",", "fixed_", ",", "showlink_", ",", "IsAKnotQ_"}],
     "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "returnlist", ",", "link", ",", "randsize", ",", " ", "linkcounter", 
       ",", "Goodknot", ",", "countercheck"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"returnlist", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"fixed", ",", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"link", "=", 
            RowBox[{"RandomLink", "[", "size", "]"}]}], ";", 
           RowBox[{"linkcounter", "=", "1"}], ";", " ", 
           RowBox[{"countercheck", "=", "1000"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"IsAKnotQ", ",", 
             RowBox[{"Goodknot", "=", 
              RowBox[{"KnotInQ", "[", "link", "]"}]}], ",", 
             RowBox[{"Goodknot", "=", "True"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Goodknot", "=", 
            RowBox[{"Goodknot", "&&", 
             RowBox[{"GoodCube", "[", 
              RowBox[{"link", ",", "1"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"Goodknot", "\[Equal]", "False"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"link", "=", 
               RowBox[{"RandomLink", "[", "size", "]"}]}], ";", 
              RowBox[{"linkcounter", "++"}], ";", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"linkcounter", "==", "countercheck"}], ",", " ", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<   \>\"", ",", "linkcounter"}], "]"}], ";", 
                 RowBox[{"countercheck", "=", 
                  RowBox[{"countercheck", "+", "1000"}]}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{"IsAKnotQ", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"KnotInQ", "[", "link", "]"}], "==", "True"}], ",",
                   " ", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"GoodCube", "[", 
                    RowBox[{"link", ",", "1"}], "]"}], "\[Equal]", "True"}], 
                    ",", " ", 
                    RowBox[{"Goodknot", "=", " ", "True"}], ",", " ", 
                    RowBox[{"Goodknot", "=", "False"}]}], "]"}], ",", " ", 
                  RowBox[{"Goodknot", "=", "False"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"GoodCube", "[", 
                    RowBox[{"link", ",", "1"}], "]"}], "\[Equal]", "True"}], 
                  ",", " ", 
                  RowBox[{"Goodknot", "=", "True"}], ",", " ", 
                  RowBox[{"Goodknot", "=", "False"}]}], "]"}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "linkcounter", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"showlink", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"returnlist", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"returnlist", ",", 
                 RowBox[{"UnShiftLink", "[", "link", "]"}]}], "]"}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"returnlist", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"returnlist", ",", 
              RowBox[{"Draw3DLink", "[", "link", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"returnlist", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"returnlist", ",", 
              RowBox[{"DrawLinkProjection", "[", 
               RowBox[{"link", ",", "1", ",", "True"}], "]"}]}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"returnlist", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"returnlist", ",", 
              RowBox[{"DrawLinkProjection", "[", 
               RowBox[{"link", ",", "2", ",", "True"}], "]"}]}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"returnlist", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"returnlist", ",", 
              RowBox[{"DrawLinkProjection", "[", 
               RowBox[{"link", ",", "3", ",", "True"}], "]"}]}], "]"}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", "num", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"SeedRandom", "[", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"randsize", "=", 
             RowBox[{"RandomInteger", "[", 
              RowBox[{"{", 
               RowBox[{"2", ",", "size"}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"link", "=", 
             RowBox[{"RandomLink", "[", "randsize", "]"}]}], ";", 
            RowBox[{"linkcounter", "=", "1"}], ";", " ", 
            RowBox[{"countercheck", "=", "1000"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"IsAKnotQ", ",", 
              RowBox[{"Goodknot", "=", 
               RowBox[{"KnotInQ", "[", "link", "]"}]}], ",", 
              RowBox[{"Goodknot", "=", "True"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Goodknot", "=", 
             RowBox[{"Goodknot", "&&", 
              RowBox[{"GoodCube", "[", 
               RowBox[{"link", ",", "1"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{"Goodknot", "\[Equal]", "False"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"link", "=", 
                RowBox[{"RandomLink", "[", "randsize", "]"}]}], ";", 
               RowBox[{"linkcounter", "++"}], ";", " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"linkcounter", "==", "countercheck"}], ",", " ", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{"\"\<   \>\"", ",", "linkcounter"}], "]"}], ";", 
                  RowBox[{"countercheck", "=", 
                   RowBox[{"countercheck", "+", "1000"}]}]}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"IsAKnotQ", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"KnotInQ", "[", "link", "]"}], "==", "True"}], 
                   ",", " ", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"GoodCube", "[", 
                    RowBox[{"link", ",", "1"}], "]"}], "\[Equal]", "True"}], 
                    ",", " ", 
                    RowBox[{"Goodknot", "=", " ", "True"}], ",", " ", 
                    RowBox[{"Goodknot", "=", "False"}]}], "]"}], ",", " ", 
                   RowBox[{"Goodknot", "=", "False"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"GoodCube", "[", 
                    RowBox[{"link", ",", "1"}], "]"}], "\[Equal]", "True"}], 
                   ",", " ", 
                   RowBox[{"Goodknot", "=", "True"}], ",", " ", 
                   RowBox[{"Goodknot", "=", "False"}]}], "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", "linkcounter", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"showlink", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"returnlist", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"returnlist", ",", 
                  RowBox[{"UnShiftLink", "[", "link", "]"}]}], "]"}]}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"returnlist", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"returnlist", ",", 
               RowBox[{"Draw3DLink", "[", "link", "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"returnlist", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"returnlist", ",", 
               RowBox[{"DrawLinkProjection", "[", 
                RowBox[{"link", ",", "1", ",", "True"}], "]"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"returnlist", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"returnlist", ",", 
               RowBox[{"DrawLinkProjection", "[", 
                RowBox[{"link", ",", "2", ",", "True"}], "]"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"returnlist", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"returnlist", ",", 
               RowBox[{"DrawLinkProjection", "[", 
                RowBox[{"link", ",", "3", ",", "True"}], "]"}]}], "]"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", "num", "}"}]}], "\[IndentingNewLine]", "]"}], ";"}]}],
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "returnlist", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4034422211934977`*^9, 3.4034422686536083`*^9}, {
   3.4034422990174522`*^9, 3.403442312816358*^9}, {3.403442618885949*^9, 
   3.4034427352282195`*^9}, 3.4034427939853635`*^9, 3.4034428736044188`*^9, {
   3.441215624607808*^9, 3.4412156286390066`*^9}, 3.4412156688103676`*^9, {
   3.4412157798245716`*^9, 3.4412157895119476`*^9}, {3.4412159124009995`*^9, 
   3.4412159153072124`*^9}, {3.441218643942676*^9, 3.441218647489528*^9}, {
   3.441218796129202*^9, 3.441218799972927*^9}, {3.44128277122725*^9, 
   3.44128286728975*^9}, {3.4412947057585*^9, 3.441294720367875*^9}, {
   3.441294874961625*^9, 3.44129489435225*^9}, {3.4412949368835*^9, 
   3.441295102492875*^9}, {3.441295137899125*^9, 3.4412951400085*^9}, {
   3.44129517572725*^9, 3.441295188117875*^9}, 3.441296163774125*^9, {
   3.4412971356335*^9, 3.441297141524125*^9}, {3.4412972806335*^9, 
   3.44129739353975*^9}, {3.44129845666475*^9, 3.44129850597725*^9}, {
   3.441298788274125*^9, 3.441298892305375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RotateFlat", "[", 
    RowBox[{"cube_", ",", "index_", ",", "dir_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"newcube", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newcube", "=", "cube"}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"cube", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"dir", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"newcube", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "index"}], "]"}], "]"}], "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"newcube", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "index"}], "]"}], "]"}], "-", 
                  "1"}], ",", "n"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"dir", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"newcube", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "index"}], "]"}], "]"}], "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"newcube", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "index"}], "]"}], "]"}], "+", 
                  "1"}], ",", "n"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"newcube", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "newcube", "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.405603388046875*^9, 3.405603428765625*^9}, {
   3.405603571203125*^9, 3.405603740734375*^9}, 3.405799706296875*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CombineStates", "[", 
     RowBox[{
     "state1_", ",", " ", "state2_", ",", " ", "proj1_", ",", " ", "proj2_"}],
      "]"}], " ", ":=", "\n", "  ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "cubestate", ",", " ", "shared", ",", " ", "scoord", ",", " ", 
        "newstate1", ",", " ", "newstate2", ",", " ", "tempcoord"}], "}"}], 
      ",", "\n", "   ", 
      RowBox[{
       RowBox[{"cubestate", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\n", "   ", 
       RowBox[{"shared", " ", "=", " ", 
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "2", ",", " ", "3"}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", " ", "2", ",", " ", "3"}], "}"}], ",", " ", 
             "proj1"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], "]"}]}], ";", "\n", 
       "   ", 
       RowBox[{"shared", " ", "=", " ", 
        RowBox[{"Delete", "[", 
         RowBox[{"shared", ",", " ", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"shared", ",", " ", "proj2"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], "]"}]}], ";", "\n", 
       "   ", 
       RowBox[{"shared", " ", "=", " ", 
        RowBox[{"shared", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "   ", 
       RowBox[{"newstate1", " ", "=", " ", "state1"}], ";", "\n", "   ", 
       RowBox[{"newstate2", " ", "=", " ", "state2"}], ";", "\n", "   ", 
       RowBox[{"Do", "[", "\n", "    ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"newstate1", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
           RowBox[{"Insert", "[", 
            RowBox[{
             RowBox[{"newstate1", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
             RowBox[{"-", "1"}], ",", " ", "proj1"}], "]"}]}], ";", "\n", 
          "    ", 
          RowBox[{
           RowBox[{"newstate2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
           RowBox[{"Insert", "[", 
            RowBox[{
             RowBox[{"newstate2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
             RowBox[{"-", "1"}], ",", " ", "proj2"}], "]"}]}]}], ",", "\n", 
         "    ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", "newstate1", "]"}]}], "}"}]}], "\n", "    ",
         "]"}], ";", "\n", "   ", 
       RowBox[{"Do", "[", "\n", "    ", 
        RowBox[{
         RowBox[{
          RowBox[{"scoord", " ", "=", " ", 
           RowBox[{"newstate1", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\n", "    ", 
          RowBox[{"Do", "[", "\n", "     ", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"newstate2", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", " ", "shared"}], "]"}], "]"}], " ", "==", 
               " ", 
               RowBox[{"newstate1", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", " ", "shared"}], "]"}], "]"}]}], ",", "\n",
               "      ", 
              RowBox[{
               RowBox[{"tempcoord", " ", "=", " ", "scoord"}], ";", "\n", 
               "      ", 
               RowBox[{
                RowBox[{"tempcoord", "[", 
                 RowBox[{"[", "proj1", "]"}], "]"}], " ", "=", " ", 
                RowBox[{"newstate2", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", " ", "proj1"}], "]"}], "]"}]}], ";", "\n",
                "      ", 
               RowBox[{"cubestate", " ", "=", " ", 
                RowBox[{"Append", "[", 
                 RowBox[{"cubestate", ",", " ", "tempcoord"}], "]"}]}], 
               ";"}]}], "\n", "      ", "]"}], ",", "\n", "     ", 
            RowBox[{"{", 
             RowBox[{"j", ",", " ", 
              RowBox[{"Length", "[", "newstate2", "]"}]}], "}"}]}], "\n", 
           "     ", "]"}]}], ",", "\n", "    ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", "newstate1", "]"}]}], "}"}]}], "\n", "    ",
         "]"}], ";", "\n", "   ", 
       RowBox[{"cubestate", " ", "=", " ", 
        RowBox[{"OrderCoordinates", "[", "cubestate", "]"}]}], ";", "\n", 
       "   ", 
       RowBox[{"Return", "[", "cubestate", "]"}], ";"}]}], "\n", "   ", 
     "]"}]}], ";"}], "\n"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.405940959140625*^9, 3.405941211859375*^9}, {
   3.4059412456875*^9, 3.40594132309375*^9}, {3.405941380984375*^9, 
   3.405941435609375*^9}, {3.405941467578125*^9, 3.40594153828125*^9}, {
   3.405941570234375*^9, 3.40594157040625*^9}, {3.405945213609375*^9, 
   3.40594522153125*^9}, {3.40594528175*^9, 3.40594528321875*^9}, {
   3.405945313734375*^9, 3.405945407453125*^9}, {3.40594544296875*^9, 
   3.40594546984375*^9}, {3.40594555825*^9, 3.405945684109375*^9}, {
   3.40594607971875*^9, 3.405946093390625*^9}, {3.405946189125*^9, 
   3.405946438421875*^9}, {3.405946518359375*^9, 3.40594652728125*^9}, {
   3.405946572484375*^9, 3.405946604875*^9}, {3.405946684578125*^9, 
   3.405946684796875*^9}, 3.443744114865719*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProjectCubeState", "[", 
    RowBox[{"state_", ",", "proj_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "planestate", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"planestate", "=", "state"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"planestate", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"planestate", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "proj"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "planestate", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"planestate", "=", 
       RowBox[{"OrderCoordinates", "[", "planestate", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "planestate", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.40594157290625*^9, 3.40594167225*^9}, 
   3.4437441148674307`*^9, 3.445013096508765*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1160, 809},
WindowMargins->{{641, Automatic}, {287, Automatic}},
FrontEndVersion->"7.0 for Microsoft Windows (32-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 155, 2, 83, "Title"],
Cell[CellGroupData[{
Cell[747, 28, 515, 12, 121, "Section"],
Cell[1265, 42, 441, 9, 127, "Text"],
Cell[1709, 53, 7762, 168, 2981, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[9508, 226, 93, 1, 41, "Section"],
Cell[CellGroupData[{
Cell[9626, 231, 226, 3, 27, "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[9855, 236, 461, 8, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[10319, 246, 224, 3, 27, "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[10546, 251, 645, 11, 47, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[11194, 264, 222, 3, 27, "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[11419, 269, 423, 7, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[11845, 278, 225, 3, 27, "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[12073, 283, 901, 14, 65, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[12977, 299, 230, 3, 27, "Subsubsection",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[13210, 304, 464, 8, 47, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[13723, 318, 197, 4, 40, "Section"],
Cell[13923, 324, 546, 10, 33, "Text"],
Cell[CellGroupData[{
Cell[14494, 338, 203, 4, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[14700, 344, 284, 6, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[14987, 352, 2157, 49, 312, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[17147, 403, 1883, 45, 312, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[19033, 450, 330, 7, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[19366, 459, 2004, 50, 312, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[21373, 511, 353, 7, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[21729, 520, 2874, 70, 372, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[24606, 592, 260, 6, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[24869, 600, 1031, 26, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[25903, 628, 289, 6, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[26195, 636, 1692, 44, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[27890, 682, 330, 7, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[28223, 691, 5250, 121, 552, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[33476, 814, 272, 6, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[33751, 822, 6785, 157, 652, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[40539, 981, 367, 7, 47, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[40909, 990, 4333, 101, 452, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[45245, 1093, 4452, 102, 452, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[49700, 1197, 369, 7, 47, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[50072, 1206, 4276, 104, 472, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[54351, 1312, 363, 7, 47, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[54717, 1321, 4842, 115, 772, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[59562, 1438, 345, 7, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[59910, 1447, 1257, 30, 192, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[61170, 1479, 319, 6, 47, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[61492, 1487, 837, 21, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[62332, 1510, 368, 7, 47, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[62703, 1519, 842, 21, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[63548, 1542, 297, 6, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[63848, 1550, 5266, 128, 572, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[69117, 1680, 256, 5, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[69376, 1687, 8568, 198, 872, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[77947, 1887, 418, 7, 65, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[78368, 1896, 3715, 88, 472, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[82086, 1986, 473, 8, 47, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[82562, 1996, 4076, 102, 472, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[86641, 2100, 294, 6, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[86938, 2108, 1580, 41, 172, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[88521, 2151, 373, 7, 47, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[88897, 2160, 2591, 59, 292, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[91491, 2221, 334, 7, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[91828, 2230, 5724, 140, 672, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[97555, 2372, 346, 6, 47, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[97904, 2380, 3018, 68, 392, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[100925, 2450, 294, 6, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[101222, 2458, 1205, 29, 192, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[102430, 2489, 350, 6, 29, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[102783, 2497, 3381, 80, 552, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[106167, 2579, 1488, 36, 172, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[107658, 2617, 913, 22, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[108574, 2641, 519, 9, 65, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[109096, 2652, 9467, 204, 992, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[118566, 2858, 1931, 50, 212, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[120500, 2910, 4437, 106, 492, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[124940, 3018, 14668, 366, 1352, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[139611, 3386, 7225, 179, 892, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[146839, 3567, 13847, 332, 1092, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[160689, 3901, 5540, 138, 452, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[166232, 4041, 5325, 136, 432, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[171560, 4179, 3042, 74, 452, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[174605, 4255, 1400, 36, 212, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[176008, 4293, 710, 20, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[176721, 4315, 4678, 124, 592, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[181402, 4441, 4687, 125, 592, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[186092, 4568, 5743, 162, 532, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[191838, 4732, 1300, 33, 212, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[193141, 4767, 1299, 33, 212, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[194443, 4802, 1945, 52, 212, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[196391, 4856, 2771, 68, 252, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[199165, 4926, 2402, 56, 372, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[201570, 4984, 3354, 78, 492, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[204927, 5064, 4751, 111, 532, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[209681, 5177, 8112, 188, 872, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[217796, 5367, 5955, 132, 652, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[223754, 5501, 4805, 100, 472, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[228562, 5603, 2666, 66, 392, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[231231, 5671, 4069, 97, 612, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[235303, 5770, 5063, 109, 632, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[240369, 5881, 1786, 39, 252, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[242158, 5922, 2363, 55, 272, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[244524, 5979, 9393, 205, 672, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[253920, 6186, 35725, 793, 1652, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[289648, 6981, 3737, 89, 352, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[293388, 7072, 5993, 136, 412, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[299384, 7210, 11161, 236, 952, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[310548, 7448, 2761, 66, 372, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[313312, 7516, 5496, 128, 592, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[318811, 7646, 1297, 31, 212, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
